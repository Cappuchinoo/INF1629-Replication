db,llm,prompt_technique,query_id,original_ms,execution_ms_original,planning_ms_original,buffers_plan_original,rewritten_ms,execution_ms_rewritten,planning_ms_rewritten,buffers_plan_rewritten,emissions_original,emissions_rewritten,speedup,same_rowcount,same_signature,original_sql,rewritten_sql
webshopdb,llama3.1:8b,chain-of-thought,1,2461.474,178.838,0.138,41037,NaN,NaN,NaN,,1.0725548761542304e-06,nan,NaN,False,False,"SELECT     c.id AS customer_id,     (SELECT c2.firstname || ' ' || c2.lastname      FROM customer c2      WHERE c2.id = c.id) AS full_name,     (       SELECT SUM(o.total::numeric)       FROM ""order"" o       WHERE o.customer = c.id         AND date_trunc('year', o.ordertimestamp) = (             SELECT date_trunc('year', MIN(ordertimestamp)) FROM ""order""         )     ) AS total_spent_last_year FROM customer c WHERE c.email IS NOT NULL    -- substitui o filtro impossível ORDER BY     (SELECT SUM(o2.total::numeric)      FROM ""order"" o2      WHERE o2.customer = c.id) DESC","SELECT            SELECT date_trunc('year', MIN(ordertimestamp)) FROM ""order"" SELECT DISTINCT *     SELECT                SELECT date_trunc('year', MIN(ordertimestamp)) FROM ""order"" SELECT DISTINCT *     SELECT                SELECT date_trunc('year', MIN(ordertimestamp)) FROM ""order"" SELECT * SELECT DISTINCT *     SELECT                SELECT date_trunc('year', MIN(ordertimestamp)) FROM ""order"""
webshopdb,llama3.1:8b,chain-of-thought,2,2869.589,12.970,0.395,464,NaN,NaN,NaN,,9.580836467502662e-07,nan,NaN,False,False,"SELECT DISTINCT     a.id AS article_id,     p.name AS product_name,     a.originalprice,     a.reducedprice,     c.name AS color_name,     random() AS rnd FROM articles a JOIN products p ON p.id = a.productid JOIN colors c ON c.id = a.colorid JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"")   AND p.name IS NOT NULL       -- substitui o filtro impossível ORDER BY rnd",WITH min_timestamp AS (   SELECT MIN(ordertimestamp) AS min_ts   SELECT * SELECT DISTINCT
webshopdb,llama3.1:8b,chain-of-thought,3,2565.628,3.578,0.197,82,NaN,NaN,NaN,,8.35016158471741e-07,nan,NaN,False,False,"SELECT     c.id,     c.firstname,     c.lastname,     c.email FROM customer c WHERE c.id IN (     SELECT DISTINCT o.customer     FROM ""order"" o     JOIN order_positions op ON op.orderid = o.id     WHERE op.amount >= 1 )",SELECT     SELECT 1
webshopdb,llama3.1:8b,chain-of-thought,4,3579.359,2.102,0.208,56,NaN,NaN,NaN,,1.0426682115351205e-06,nan,NaN,False,False,"SELECT DISTINCT     c.id,     c.firstname,     c.lastname,     o.id AS order_id,     o.ordertimestamp FROM customer c LEFT JOIN ""order"" o ON o.customer = c.id WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") ORDER BY o.ordertimestamp DESC","SELECT          SELECT MIN(ordertimestamp) FROM ""order"""
webshopdb,1,1831.050,9.585,0.158,10828,1823.664,1.894,0.260,41,5.061,264.098,2.194643299324719e-05,2.1582959331512566e-05,True,False,"SELECT     c.id AS customer_id,     (SELECT c2.firstname || ' ' || c2.lastname      FROM customer c2      WHERE c2.id = c.id) AS full_name,     (       SELECT SUM(o.total::numeric)       FROM ""order"" o       WHERE o.customer = c.id         AND date_trunc('year', o.ordertimestamp) = (             SELECT date_trunc('year', MIN(ordertimestamp)) FROM ""order""         )     ) AS total_spent_last_year FROM customer c WHERE c.email IS NOT NULL    -- substitui o filtro impossível ORDER BY     (SELECT SUM(o2.total::numeric)      FROM ""order"" o2      WHERE o2.customer = c.id) DESC","SELECT      c.id AS customer_id,     c.firstname || ' ' || c.lastname AS full_name,     COALESCE(SUM(o.total::numeric), 0) AS total_spent_last_year FROM customer c LEFT JOIN ""order"" o ON (     o.customer = c.id AND date_trunc('year', o.ordertimestamp) = (         SELECT date_trunc('year', MIN(ordertimestamp)) FROM ""order""     ) ) GROUP BY c.id, c.firstname, c.lastname ORDER BY COALESCE(SUM(o.total::numeric), 0) DESC"
webshopdb,2,2328.442,13.105,0.533,449,2253.988,13.335,0.467,449,0.983,1.000,2.775436278168492e-05,2.7172144644637962e-05,True,False,"SELECT DISTINCT     a.id AS article_id,     p.name AS product_name,     a.originalprice,     a.reducedprice,     c.name AS color_name,     random() AS rnd FROM articles a JOIN products p ON p.id = a.productid JOIN colors c ON c.id = a.colorid JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"")   AND p.name IS NOT NULL       -- substitui o filtro impossível ORDER BY rnd","SELECT DISTINCT      a.id AS article_id,      p.name AS product_name,      a.originalprice,      a.reducedprice,      c.name AS color_name,      random() AS rnd FROM articles a JOIN products p ON p.id = a.productid JOIN colors c ON c.id = a.colorid JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"")   AND p.name IS NOT NULL ORDER BY random();"
webshopdb,3,1737.822,3.367,0.204,82,1769.873,3.630,0.217,82,0.928,1.000,2.115274551068163e-05,2.1022166519131227e-05,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     c.email FROM customer c WHERE c.id IN (     SELECT DISTINCT o.customer     FROM ""order"" o     JOIN order_positions op ON op.orderid = o.id     WHERE op.amount >= 1 )","SELECT      c.id,      c.firstname,      c.lastname,      c.email FROM customer c JOIN (     SELECT DISTINCT o.customer AS customer_id     FROM ""order"" o     JOIN order_positions op ON op.orderid = o.id     WHERE op.amount >= 1 ) sub ON sub.customer_id = c.id"
webshopdb,4,1930.298,1.912,0.273,41,nan,,,,,,2.3424788265011778e-05,nan,False,False,"SELECT DISTINCT     c.id,     c.firstname,     c.lastname,     o.id AS order_id,     o.ordertimestamp FROM customer c LEFT JOIN ""order"" o ON o.customer = c.id WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") ORDER BY o.ordertimestamp DESC","SELECT DISTINCT      c.id,     c.firstname,     c.lastname,     o.id AS order_id,     o.ordertimestamp FROM customer c LEFT JOIN (     SELECT id, ordertimestamp     FROM ""order"" ) o ON o.customer = c.id AND o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") ORDER BY o.ordertimestamp DESC"
webshopdb,5,1755.137,4.984,0.227,3676,1759.982,4.998,0.160,3676,0.997,1.000,2.1351934914703454e-05,2.1189094692046342e-05,True,False,"SELECT     c.id,     c.firstname,     c.lastname,     (         SELECT SUM(o.total::numeric)         FROM ""order"" o         WHERE o.customer = c.id     ) AS total_spent FROM customer c WHERE c.id IN (SELECT customer FROM ""order"") ORDER BY total_spent DESC NULLS LAST","SELECT      c.id,      c.firstname,      c.lastname,      (         SELECT SUM(o.total::numeric)         FROM ""order"" o         WHERE o.customer = c.id     ) AS total_spent FROM customer c JOIN (SELECT DISTINCT customer FROM ""order"") sub ON sub.customer = c.id ORDER BY 3 DESC NULLS LAST"
webshopdb,6,1480.010,11.777,0.506,448,1462.997,11.493,0.512,448,1.025,1.000,1.7905808658116406e-05,1.7373944130524288e-05,True,True,"SELECT     p.id AS product_id,     p.name AS product_name,     SUM(op.amount * op.price::numeric) AS revenue_period FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"")   AND p.currentlyactive = TRUE GROUP BY p.id, p.name ORDER BY revenue_period DESC LIMIT 10","SELECT      p.id AS product_id,     p.name AS product_name,     SUM(op.amount * op.price::numeric) AS revenue_period FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"")   AND p.currentlyactive = TRUE GROUP BY p.id, p.name ORDER BY revenue_period DESC LIMIT 10"
webshopdb,7,1614.813,1.368,0.222,37,1621.120,1.433,0.244,37,0.955,1.000,1.947973190253504e-05,1.9187110205550338e-05,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     COUNT(o.id) AS num_orders FROM customer c JOIN ""order"" o ON o.customer = c.id GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(o.id) >= 5 ORDER BY num_orders DESC LIMIT 50","SELECT     c.id,     c.firstname,     c.lastname,     COUNT(o.id) AS num_orders FROM customer c JOIN ""order"" o ON o.customer = c.id GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(o.id) >= 5 ORDER BY num_orders DESC LIMIT 50"
webshopdb,8,1743.196,1.500,0.252,41,1445.773,0.042,0.299,9,35.714,4.556,2.1060773378299645e-05,1.712057712673665e-05,False,False,"SELECT     o.id AS order_id,     o.ordertimestamp,     c.id AS customer_id,     c.firstname,     c.lastname,     o.total,     o.shippingcost FROM ""order"" o JOIN customer c ON c.id = o.customer WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") ORDER BY o.ordertimestamp DESC LIMIT 500","SELECT      o.id AS order_id,      o.ordertimestamp,     c.id AS customer_id,      c.firstname,      c.lastname,      o.total,      o.shippingcost FROM ""order"" o JOIN (     SELECT id FROM ""order""     ORDER BY ordertimestamp ASC     LIMIT 1 ) sub ON o.id = sub.id JOIN customer c ON c.id = o.customer"
webshopdb,9,1777.853,9.199,0.371,448,1797.056,9.557,0.406,448,0.963,1.000,2.15333498028227e-05,2.1271823375230386e-05,True,True,"SELECT     p.category,     p.id AS product_id,     p.name AS product_name,     SUM(op.amount) AS total_qty FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") GROUP BY p.category, p.id, p.name ORDER BY p.category, total_qty DESC","SELECT      p.category,     p.id AS product_id,     p.name AS product_name,     SUM(op.amount) AS total_qty FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") GROUP BY 1,2,3 ORDER BY 1,4 DESC"
webshopdb,10,1647.735,1.798,0.245,37,1650.696,1.714,0.238,37,1.049,1.000,2.000502184364277e-05,1.9704721305518467e-05,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     MAX(o.ordertimestamp) AS last_order_timestamp FROM customer c LEFT JOIN ""order"" o ON o.customer = c.id GROUP BY c.id, c.firstname, c.lastname HAVING MAX(o.ordertimestamp) < current_date - interval '6 months'     OR MAX(o.ordertimestamp) IS NULL ORDER BY last_order_timestamp NULLS FIRST LIMIT 200","SELECT      c.id,     c.firstname,     c.lastname,     MAX(o.ordertimestamp) AS last_order_timestamp FROM customer c LEFT JOIN ""order"" o ON o.customer = c.id GROUP BY c.id, c.firstname, c.lastname HAVING (MAX(o.ordertimestamp) < current_date - interval '6 months'         OR MAX(o.ordertimestamp) IS NULL) ORDER BY last_order_timestamp NULLS FIRST LIMIT 200"
webshopdb,11,1458.155,2.252,0.230,37,1430.085,2.934,0.224,37,0.768,1.000,1.7546590208368677e-05,1.704226279387612e-05,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     COUNT(o.id) AS num_orders,     SUM(o.total::numeric) AS total_spent,     AVG(o.total::numeric) AS avg_order_value FROM customer c JOIN ""order"" o ON o.customer = c.id GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(o.id) >= 3 ORDER BY avg_order_value DESC LIMIT 20;","SELECT      c.id,     c.firstname,     c.lastname,     SUM(CASE WHEN o.id IS NOT NULL THEN 1 ELSE 0 END) AS num_orders,     SUM(o.total::numeric) AS total_spent,     AVG(o.total::numeric) AS avg_order_value FROM customer c LEFT JOIN ""order"" o ON o.customer = c.id GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(DISTINCT o.id) >= 3 ORDER BY avg_order_value DESC LIMIT 20;"
webshopdb,12,1475.795,20.220,0.420,538,1630.816,19.996,0.413,538,1.011,1.000,1.7813062681193905e-05,1.936854694657523e-05,False,False,"SELECT     p.id AS product_id,     p.name AS product_name,     COALESCE(SUM(s.count), 0) AS total_stock,     COALESCE(SUM(op.amount), 0) AS total_sold FROM products p JOIN articles a ON a.productid = p.id LEFT JOIN stock s ON s.articleid = a.id LEFT JOIN order_positions op ON op.articleid = a.id GROUP BY p.id, p.name HAVING COALESCE(SUM(s.count), 0) < 10   -- “baixo” estoque ORDER BY total_stock ASC, total_sold DESC;","SELECT      p.id AS product_id,     p.name AS product_name,     COALESCE(COUNT(s.articleid), 0) AS total_stock,     COALESCE(SUM(op.amount), 0) AS total_sold FROM products p JOIN articles a ON a.productid = p.id LEFT JOIN stock s ON s.articleid = a.id LEFT JOIN order_positions op ON op.articleid = a.id GROUP BY p.id, p.name HAVING COALESCE(COUNT(s.articleid), 0) < 10 ORDER BY total_stock ASC, total_sold DESC;"
webshopdb,13,1639.039,13.638,0.353,444,1610.126,15.638,0.366,444,0.872,1.000,1.981435178171757e-05,1.9613511736567608e-05,True,True,"SELECT     date_trunc('month', o.ordertimestamp) AS month,     p.category,     SUM(op.amount * op.price::numeric) AS revenue FROM ""order"" o JOIN order_positions op ON op.orderid = o.id JOIN articles a ON a.id = op.articleid JOIN products p ON p.id = a.productid GROUP BY month, p.category ORDER BY month, revenue DESC;","SELECT      date_trunc('month', o.ordertimestamp) AS month,     p.category,     SUM(op.amount * op.price::numeric) AS revenue FROM ""order"" o JOIN order_positions op ON op.orderid = o.id JOIN articles a ON a.id = op.articleid JOIN products p ON p.id = a.productid GROUP BY 1, 2 ORDER BY 1, 3 DESC;"
webshopdb,14,1786.192,13.855,0.486,462,1797.864,14.001,0.581,462,0.990,1.000,2.1494392379128685e-05,2.1301905500241054e-05,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     COUNT(DISTINCT p.category) AS categories_bought FROM customer c JOIN ""order"" o ON o.customer = c.id JOIN order_positions op ON op.orderid = o.id JOIN articles a ON a.id = op.articleid JOIN products p ON p.id = a.productid GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(DISTINCT p.category) >= 3 ORDER BY categories_bought DESC, c.id;","SELECT      c.id,     c.firstname,     c.lastname,     COUNT(DISTINCT CASE WHEN p.category IS NOT NULL THEN p.category END) AS categories_bought FROM customer c JOIN ""order"" o ON o.customer = c.id JOIN order_positions op ON op.orderid = o.id JOIN articles a ON a.id = op.articleid JOIN products p ON p.id = a.productid GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(DISTINCT CASE WHEN p.category IS NOT NULL THEN p.category END) >= 3 ORDER BY categories_bought DESC, c.id"
webshopdb,15,1759.730,11.656,0.601,566,1795.653,15.819,0.588,561,0.737,1.009,2.1421721280065036e-05,2.1773723348927976e-05,True,True,"WITH bounds AS (     SELECT (SELECT MAX(ordertimestamp) FROM ""order"") AS max_ts ) SELECT     a.id AS article_id,     a.description,     p.name AS product_name,     COALESCE(SUM(s.count), 0) AS current_stock,     COUNT(DISTINCT o.id) AS num_orders_recent FROM articles a JOIN products p ON p.id = a.productid LEFT JOIN stock s ON s.articleid = a.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid CROSS JOIN bounds b WHERE o.ordertimestamp >= b.max_ts - interval '1 year' GROUP BY a.id, a.description, p.name HAVING COALESCE(SUM(s.count), 0) = 0 ORDER BY num_orders_recent DESC;","SELECT      a.id AS article_id,     a.description,     p.name AS product_name,     COALESCE(SUM(COALESCE(s.count, 0)), 0) AS current_stock,     COUNT(DISTINCT o.id) AS num_orders_recent FROM articles a JOIN products p ON p.id = a.productid LEFT JOIN stock s ON s.articleid = a.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (     SELECT MAX(ordertimestamp) - INTERVAL '1 year'     FROM ""order"" ) GROUP BY a.id, a.description, p.name HAVING COALESCE(SUM(COALESCE(s.count, 0)), 0) = 0 ORDER BY num_orders_recent DESC;"
webshopdb,16,1609.549,6.915,0.237,425,1474.846,9.078,0.252,425,0.762,1.000,1.945772413953128e-05,1.7487610399042574e-05,False,False,"SELECT     p.id,     p.name FROM products p WHERE p.id NOT IN (     SELECT DISTINCT a.productid     FROM articles a     JOIN order_positions op ON op.articleid = a.id );","SELECT  	p.id,  	p.name  FROM  	products p  WHERE  	p.id NOT IN ( 		SELECT DISTINCT a.productid  		FROM articles a  		LEFT JOIN order_positions op ON op.articleid = a.id  	WHERE op.articleid IS NULL  );"
webshopdb,17,1899.304,390.537,0.368,128697,1874.061,391.857,0.410,128697,0.997,1.000,2.300957997743158e-05,2.26806781334392e-05,True,True,"SELECT     p.id,     p.name,     p.category,     a.reducedprice,     (         SELECT AVG(a2.reducedprice::numeric)         FROM articles a2         JOIN products p2 ON p2.id = a2.productid         WHERE p2.category = p.category     ) AS avg_category_price FROM products p JOIN articles a ON a.productid = p.id WHERE a.reducedprice::numeric > (     SELECT AVG(a3.reducedprice::numeric)     FROM articles a3     JOIN products p3 ON p3.id = a3.productid     WHERE p3.category = p.category ) LIMIT 50;","SELECT      p.id,     p.name,     p.category,     a.reducedprice,     (         SELECT AVG(a2.reducedprice::numeric)         FROM articles a2         JOIN products p2 ON p2.id = a2.productid AND p2.category = p.category     ) AS avg_category_price FROM products p JOIN articles a ON a.productid = p.id WHERE (a.reducedprice::numeric > (     SELECT AVG(a3.reducedprice::numeric)     FROM articles a3     JOIN products p3 ON p3.id = a3.productid AND p3.category = p.category )) LIMIT 50;"
webshopdb,18,1600.912,4.266,0.110,3921,1580.916,2.006,0.153,37,2.127,105.973,1.9440611297642754e-05,1.890020342603044e-05,True,False,"SELECT      c.id,      c.firstname,      c.lastname FROM customer c ORDER BY (     SELECT SUM(o.total::numeric)      FROM ""order"" o      WHERE o.customer = c.id ) DESC  LIMIT 50;","SELECT      c.id,      c.firstname,      c.lastname FROM customer c JOIN (     SELECT          o.customer AS order_customer_id,          SUM(o.total::numeric) AS total_spent     FROM ""order"" o     GROUP BY o.customer ) sub ON sub.order_customer_id = c.id ORDER BY sub.total_spent DESC LIMIT 50;"
webshopdb,19,1783.623,2.693,0.123,2713,1790.217,1.136,0.141,37,2.371,73.324,2.147718330689375e-05,2.123628291136759e-05,True,True,"SELECT      c.id,     c.firstname,     (SELECT COUNT(*) FROM ""order"" o WHERE o.customer = c.id) AS total_orders FROM customer c WHERE c.id < 1000;","SELECT      c.id,     c.firstname,     COALESCE(o.count, 0) AS total_orders FROM customer c LEFT JOIN (     SELECT customer, COUNT(*) AS count     FROM ""order""     GROUP BY customer ) o ON c.id = o.customer WHERE c.id < 1000"
webshopdb,20,1579.277,0.887,0.087,19,nan,,,,,,1.9029556562355546e-05,nan,False,False,"SELECT      o.id,     o.ordertimestamp,     o.total FROM ""order"" o WHERE EXTRACT(MONTH FROM o.ordertimestamp) = 12   AND o.total::numeric > 50;","SELECT      o.id,     o.ordertimestamp,     o.total FROM ""order"" o WHERE EXTRACT(MONTH FROM o.ordertimestamp) = 12   AND o.total > 50;"
webshopdb,21,1798.023,15.711,0.313,493,1749.642,15.360,0.318,493,1.023,1.000,2.1539135680876543e-05,2.070319444837695e-05,True,True,"SELECT     p.id AS product_id,     p.name AS product_name,     COALESCE(SUM(s.count), 0) AS total_stock FROM products p LEFT JOIN articles a ON a.productid = p.id LEFT JOIN stock s ON s.articleid = a.id GROUP BY p.id, p.name ORDER BY total_stock DESC;","SELECT      p.id AS product_id,     p.name AS product_name,     COALESCE(SUM(s.count), 0) AS total_stock FROM products p LEFT JOIN articles a ON a.productid = p.id LEFT JOIN stock s ON s.articleid = a.id GROUP BY p.id, p.name ORDER BY COALESCE(SUM(s.count), 0) DESC;"
webshopdb,22,1429.705,0.028,0.085,1,1403.714,0.042,0.114,1,0.667,1.000,1.7267554583961503e-05,1.671845530847661e-05,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     c.email,     c.created FROM customer c WHERE c.created >= CURRENT_DATE - INTERVAL '30 days' ORDER BY c.created DESC;","SELECT      c.id,      c.firstname,      c.lastname,      c.email,      c.created FROM (     SELECT DISTINCT id, firstname, lastname, email, created     FROM customer ) AS c WHERE c.created >= CURRENT_DATE - INTERVAL '30 days' ORDER BY c.created DESC;"
webshopdb,23,1461.713,8.724,0.327,425,1489.614,8.503,0.351,425,1.026,1.000,1.773340561796405e-05,1.8259733563863847e-05,True,True,"SELECT     p.id AS product_id,     p.name AS product_name,     SUM(op.amount) AS total_sold FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 20;","SELECT      p.id AS product_id,     p.name AS product_name,     SUM(op.amount) AS total_sold FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 20;"
webshopdb,24,1447.964,0.068,0.517,4,nan,,,,,,1.7524010250260845e-05,nan,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     COUNT(DISTINCT p.category) AS categories_bought FROM customer c JOIN ""order"" o ON o.customer = c.id JOIN order_positions op ON op.orderid = o.id JOIN articles a ON a.id = op.articleid JOIN products p ON p.id = a.productid WHERE o.ordertimestamp >= CURRENT_DATE - INTERVAL '6 months' GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(DISTINCT p.category) >= 4 ORDER BY categories_bought DESC;","SELECT      c.id,     c.firstname,     c.lastname,     COUNT(DISTINCT p.category) AS categories_bought FROM customer c JOIN ""order"" o ON o.customer = c.id JOIN order_positions op ON op.orderid = o.id JOIN articles a ON a.id = op.articleid JOIN products p ON p.id = a.productid WHERE o.ordertimestamp >= CURRENT_DATE - INTERVAL '6 months' GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(DISTINCT p.category) >= 4 ORDER BY categories_bought DESC;  -- Optimized query: SELECT      c.id,     c.firstname,     c.lastname,     SUM(CASE WHEN p.category IS NOT NULL THEN 1 ELSE 0 END) OVER (PARTITION BY c.id) AS categories_bought FROM customer c JOIN ""order"" o ON o.customer = c.id JOIN order_positions op ON op.orderid = o.id JOIN articles a ON a.id = op.articleid LEFT JOIN products p ON p.id = a.productid WHERE o.ordertimestamp >= CURRENT_DATE - INTERVAL '6 months' GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(DISTINCT CASE WHEN p.category IS NOT NULL THEN p.category END) >= 4;"
webshopdb,25,1467.145,16.770,0.330,520,1445.691,17.002,0.375,520,0.986,1.000,1.779713859965486e-05,1.7171579412227753e-05,True,True,"WITH stats AS (     SELECT         a.id AS article_id,         a.description,         SUM(op.amount) AS total_sold,         COALESCE(SUM(s.count), 0) AS current_stock     FROM articles a     LEFT JOIN stock s ON s.articleid = a.id     JOIN order_positions op ON op.articleid = a.id     GROUP BY a.id, a.description ) SELECT     article_id,     description,     total_sold,     current_stock,     (total_sold * 1.0 / NULLIF(current_stock, 0)) AS demand_index FROM stats ORDER BY demand_index DESC NULLS LAST LIMIT 10;","SELECT      a.id AS article_id,     a.description,     SUM(op.amount) AS total_sold,     COALESCE(SUM(s.count), 0) AS current_stock,     (SUM(op.amount) * 1.0 / NULLIF(COALESCE(SUM(s.count), 0), 0)) AS demand_index FROM articles a LEFT JOIN stock s ON s.articleid = a.id JOIN order_positions op ON op.articleid = a.id GROUP BY a.id, a.description ORDER BY (SUM(op.amount) * 1.0 / NULLIF(COALESCE(SUM(s.count), 0), 0)) DESC NULLS LAST LIMIT 10;"
