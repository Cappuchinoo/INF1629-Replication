db,llm,prompt_technique,query_id,original_ms,execution_ms_original,planning_ms_original,buffers_plan_original,rewritten_ms,execution_ms_rewritten,planning_ms_rewritten,buffers_plan_rewritten,speedup,same_rowcount,same_signature,original_sql,rewritten_sql
webshopdb,mistral-small-latest,chain-of-thought,1,1916.687,184.598,0.159,41037,1559.092,3.059,0.281,75,1.229,False,False,"SELECT     c.id AS customer_id,     (SELECT c2.firstname || ' ' || c2.lastname      FROM customer c2      WHERE c2.id = c.id) AS full_name,     (       SELECT SUM(o.total::numeric)       FROM ""order"" o       WHERE o.customer = c.id         AND date_trunc('year', o.ordertimestamp) = (             SELECT date_trunc('year', MIN(ordertimestamp)) FROM ""order""         )     ) AS total_spent_last_year FROM customer c WHERE c.email IS NOT NULL    -- substitui o filtro impossível ORDER BY     (SELECT SUM(o2.total::numeric)      FROM ""order"" o2      WHERE o2.customer = c.id) DESC","WITH customer_orders AS (     SELECT         c.id AS customer_id,         c.firstname || ' ' || c.lastname AS full_name,         SUM(o.total::numeric) AS total_spent_last_year     FROM customer c     JOIN ""order"" o ON o.customer = c.id     WHERE c.email IS NOT NULL     AND date_trunc('year', o.ordertimestamp) = (         SELECT date_trunc('year', MIN(ordertimestamp)) FROM ""order""     )     GROUP BY c.id, c.firstname, c.lastname ), customer_lifetime_spending AS (     SELECT         o.customer AS customer_id,         SUM(o.total::numeric) AS lifetime_spending     FROM ""order"" o     GROUP BY o.customer ) SELECT     co.customer_id,     co.full_name,     co.total_spent_last_year FROM customer_orders co JOIN customer_lifetime_spending cls ON cls.customer_id = co.customer_id ORDER BY cls.lifetime_spending DESC"
webshopdb,mistral-small-latest,chain-of-thought,2,2198.225,13.411,0.411,464,nan,,,,,False,False,"SELECT DISTINCT     a.id AS article_id,     p.name AS product_name,     a.originalprice,     a.reducedprice,     c.name AS color_name,     random() AS rnd FROM articles a JOIN products p ON p.id = a.productid JOIN colors c ON c.id = a.colorid JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"")   AND p.name IS NOT NULL       -- substitui o filtro impossível ORDER BY rnd","SELECT DISTINCT     a.id AS article_id,     p.name AS product_name,     a.originalprice,     a.reducedprice,     c.name AS color_name,     random() AS rnd FROM articles a JOIN products p ON p.id = a.productid JOIN colors c ON c.id = a.colorid JOIN order_positions op ON op.articleid = a.id JOIN order o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM order)   AND p.name IS NOT NULL ORDER BY rnd"
webshopdb,mistral-small-latest,chain-of-thought,3,1712.664,3.403,0.190,82,1712.837,3.636,0.210,82,1.000,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     c.email FROM customer c WHERE c.id IN (     SELECT DISTINCT o.customer     FROM ""order"" o     JOIN order_positions op ON op.orderid = o.id     WHERE op.amount >= 1 )","SELECT c.id, c.firstname, c.lastname, c.email FROM customer c WHERE EXISTS (     SELECT 1     FROM ""order"" o     JOIN order_positions op ON op.orderid = o.id     WHERE op.amount >= 1 AND o.customer = c.id )"
webshopdb,mistral-small-latest,chain-of-thought,4,2021.681,2.114,0.219,56,2030.315,2.084,0.216,56,0.996,True,True,"SELECT DISTINCT     c.id,     c.firstname,     c.lastname,     o.id AS order_id,     o.ordertimestamp FROM customer c LEFT JOIN ""order"" o ON o.customer = c.id WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") ORDER BY o.ordertimestamp DESC","SELECT DISTINCT     c.id,     c.firstname,     c.lastname,     o.id AS order_id,     o.ordertimestamp FROM customer c LEFT JOIN ""order"" o ON o.customer = c.id WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") ORDER BY o.ordertimestamp DESC"
webshopdb,mistral-small-latest,chain-of-thought,5,1782.341,75.470,0.180,16529,1742.077,1.951,0.170,37,1.023,False,False,"SELECT     c.id,     c.firstname,     c.lastname,     (         SELECT SUM(o.total::numeric)         FROM ""order"" o         WHERE o.customer = c.id     ) AS total_spent FROM customer c WHERE c.id IN (SELECT customer FROM ""order"") ORDER BY total_spent DESC NULLS LAST","SELECT c.id, c.firstname, c.lastname, COALESCE(SUM(o.total)::numeric, 0) AS total_spent FROM customer c LEFT JOIN ""order"" o ON c.id = o.customer GROUP BY c.id, c.firstname, c.lastname ORDER BY total_spent DESC NULLS LAST"
webshopdb,mistral-small-latest,chain-of-thought,6,1435.249,12.535,0.387,463,1420.631,11.827,0.399,463,1.010,True,True,"SELECT     p.id AS product_id,     p.name AS product_name,     SUM(op.amount * op.price::numeric) AS revenue_period FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"")   AND p.currentlyactive = TRUE GROUP BY p.id, p.name ORDER BY revenue_period DESC LIMIT 10","SELECT p.id AS product_id, p.name AS product_name, SUM(op.amount * op.price::numeric) AS revenue_period FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"" LIMIT 1)   AND p.currentlyactive = TRUE GROUP BY p.id, p.name ORDER BY revenue_period DESC LIMIT 10"
webshopdb,mistral-small-latest,chain-of-thought,7,1567.473,1.283,0.201,37,1548.720,1.323,0.205,37,1.012,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     COUNT(o.id) AS num_orders FROM customer c JOIN ""order"" o ON o.customer = c.id GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(o.id) >= 5 ORDER BY num_orders DESC LIMIT 50","SELECT     c.id,     c.firstname,     c.lastname,     COUNT(o.id) AS num_orders FROM customer c JOIN ""order"" o ON o.customer = c.id GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(o.id) >= 5 ORDER BY num_orders DESC LIMIT 50"
webshopdb,mistral-small-latest,chain-of-thought,8,1714.312,1.923,0.234,56,nan,,,,,False,False,"SELECT     o.id AS order_id,     o.ordertimestamp,     c.id AS customer_id,     c.firstname,     c.lastname,     o.total,     o.shippingcost FROM ""order"" o JOIN customer c ON c.id = o.customer WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") ORDER BY o.ordertimestamp DESC LIMIT 500","SELECT o.id AS order_id, o.ordertimestamp, c.id AS customer_id, c.firstname, c.lastname, o.total, o.shippingcost FROM ""order"" o JOIN customer c ON c.id = o.customer WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"" ORDER BY ordertimestamp ASC LIMIT 1) ORDER BY o.ordertimestamp DESC LIMIT 500"
webshopdb,mistral-small-latest,chain-of-thought,9,1721.596,10.165,0.328,463,1703.289,9.698,0.334,463,1.011,True,True,"SELECT     p.category,     p.id AS product_id,     p.name AS product_name,     SUM(op.amount) AS total_qty FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") GROUP BY p.category, p.id, p.name ORDER BY p.category, total_qty DESC","SELECT p.category, p.id AS product_id, p.name AS product_name, SUM(op.amount) AS total_qty FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"" LIMIT 1) GROUP BY p.category, p.id, p.name ORDER BY p.category, total_qty DESC"
webshopdb,mistral-small-latest,chain-of-thought,10,1543.825,1.721,0.186,37,1630.959,89.752,0.166,19021,0.947,True,False,"SELECT     c.id,     c.firstname,     c.lastname,     MAX(o.ordertimestamp) AS last_order_timestamp FROM customer c LEFT JOIN ""order"" o ON o.customer = c.id GROUP BY c.id, c.firstname, c.lastname HAVING MAX(o.ordertimestamp) < current_date - interval '6 months'     OR MAX(o.ordertimestamp) IS NULL ORDER BY last_order_timestamp NULLS FIRST LIMIT 200","SELECT     c.id,     c.firstname,     c.lastname,     MAX(o.ordertimestamp) AS last_order_timestamp FROM customer c LEFT JOIN LATERAL (     SELECT ordertimestamp     FROM ""order""     WHERE customer = c.id     ORDER BY ordertimestamp DESC     LIMIT 1 ) o ON true GROUP BY c.id, c.firstname, c.lastname HAVING MAX(o.ordertimestamp) < current_date - interval '6 months'     OR MAX(o.ordertimestamp) IS NULL ORDER BY last_order_timestamp NULLS FIRST LIMIT 200"
