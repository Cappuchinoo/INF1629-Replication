db,llm,prompt_technique,query_id,original_ms,execution_ms_original,planning_ms_original,buffers_plan_original,rewritten_ms,execution_ms_rewritten,planning_ms_rewritten,buffers_plan_rewritten,emissions_original,emissions_rewritten,speedup,same_rowcount,same_signature,original_sql,rewritten_sql
webshopdb,mistral-nemo,chain-of-thought,1,1640.021,9.329,0.163,10828,1142.982,NaN,NaN,,0.0000179374,0.0000124936,1.435,False,False,"SELECT     c.id AS customer_id,     (SELECT c2.firstname || ' ' || c2.lastname      FROM customer c2      WHERE c2.id = c.id) AS full_name,     (       SELECT SUM(o.total::numeric)       FROM ""order"" o       WHERE o.customer = c.id         AND date_trunc('year', o.ordertimestamp) = (             SELECT date_trunc('year', MIN(ordertimestamp)) FROM ""order""         )     ) AS total_spent_last_year FROM customer c WHERE c.email IS NOT NULL    -- substitui o filtro impossível ORDER BY     (SELECT SUM(o2.total::numeric)      FROM ""order"" o2      WHERE o2.customer = c.id) DESC","SELECT     c.id AS customer_id,     CONCAT(c.firstname, ' ', c.lastname) AS full_name,     COALESCE(SUM(o.total), 0) AS total_spent_last_year FROM     customer c LEFT JOIN LATERAL (     SELECT SUM(total::numeric) AS last_year_total     FROM ""order"" o     WHERE o.customer = c.id AND date_trunc('year', o.ordertimestamp) = (         SELECT date_trunc('year', MIN(ordertimestamp)) FROM ""order""     ) ) o_lateral ON TRUE WHERE     c.email IS NOT NULL GROUP BY     c.id,     full_name ORDER BY     total_spent_last_year DESC;"
webshopdb,mistral-nemo,chain-of-thought,2,1973.471,12.411,0.482,449,1254.897,10.865,0.885,456,0.0000215661,0.0000137072,1.573,False,False,"SELECT DISTINCT     a.id AS article_id,     p.name AS product_name,     a.originalprice,     a.reducedprice,     c.name AS color_name,     random() AS rnd FROM articles a JOIN products p ON p.id = a.productid JOIN colors c ON c.id = a.colorid JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"")   AND p.name IS NOT NULL       -- substitui o filtro impossível ORDER BY rnd","WITH min_order_timestamp AS (   SELECT MIN(ordertimestamp) AS min_timestamp FROM ""order"" ) SELECT DISTINCT     a.id AS article_id,     p.name AS product_name,     a.originalprice,     a.reducedprice,     c.name AS color_name,     random() AS rnd FROM articles a JOIN products p ON a.productid = p.id JOIN colors c ON a.colorid = c.id JOIN order_positions op ON a.id = op.articleid JOIN ""order"" o ON op.orderid = o.id JOIN min_order_timestamp mt ON o.ordertimestamp >= mt.min_timestamp WHERE p.name IS NOT NULL -- Assuming the check constraint or trigger is in place ORDER BY rnd LIMIT 100; -- Limit the result set to improve performance"
webshopdb,mistral-nemo,chain-of-thought,3,1566.376,3.316,0.239,82,1423.686,3.389,0.275,82,0.0000171195,0.0000155810,1.100,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     c.email FROM customer c WHERE c.id IN (     SELECT DISTINCT o.customer     FROM ""order"" o     JOIN order_positions op ON op.orderid = o.id     WHERE op.amount >= 1 )","SELECT     c.id,     c.firstname,     c.lastname,     c.email FROM customer c WHERE EXISTS (     SELECT 1     FROM ""order"" o     JOIN order_positions op ON op.orderid = o.id AND op.amount >= 1     WHERE o.customer = c.id )"
webshopdb,mistral-nemo,chain-of-thought,4,1556.177,1.785,0.201,41,1605.347,0.996,0.235,41,0.0000170125,0.0000175470,0.969,False,False,"SELECT DISTINCT     c.id,     c.firstname,     c.lastname,     o.id AS order_id,     o.ordertimestamp FROM customer c LEFT JOIN ""order"" o ON o.customer = c.id WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") ORDER BY o.ordertimestamp DESC","WITH filtered_orders AS (   SELECT id, customer, ordertimestamp   FROM ""order""   WHERE ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") ) SELECT   c.id,   c.firstname,   c.lastname,   o.id AS order_id,   o.ordertimestamp FROM customer c LEFT JOIN filtered_orders o ON o.customer = c.id;"
webshopdb,mistral-nemo,chain-of-thought,5,1409.161,5.066,0.259,3676,1327.956,2.899,0.290,56,0.0000153912,0.0000145341,1.061,False,False,"SELECT     c.id,     c.firstname,     c.lastname,     (         SELECT SUM(o.total::numeric)         FROM ""order"" o         WHERE o.customer = c.id     ) AS total_spent FROM customer c WHERE c.id IN (SELECT customer FROM ""order"") ORDER BY total_spent DESC NULLS LAST","WITH order_totals AS (   SELECT customer, SUM(total::numeric) AS total_spent   FROM ""order""   GROUP BY customer )  SELECT   c.id,   c.firstname,   c.lastname,   ot.total_spent FROM   customer c LEFT JOIN   order_totals ot ON c.id = ot.customer WHERE   EXISTS (     SELECT 1     FROM ""order"" o     WHERE o.customer = c.id   ) ORDER BY   ot.total_spent DESC NULLS LAST LIMIT 100; -- Change the LIMIT value as needed"
webshopdb,mistral-nemo,chain-of-thought,6,1177.708,11.919,0.525,448,1247.726,15.291,0.468,448,0.0000129066,0.0000136490,0.944,True,True,"SELECT     p.id AS product_id,     p.name AS product_name,     SUM(op.amount * op.price::numeric) AS revenue_period FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"")   AND p.currentlyactive = TRUE GROUP BY p.id, p.name ORDER BY revenue_period DESC LIMIT 10","WITH ordered_products AS (   SELECT     p.id AS product_id,     p.name AS product_name,     SUM(op.amount * op.price::numeric) AS revenue_period   FROM products p   JOIN articles a ON a.productid = p.id   JOIN order_positions op ON op.articleid = a.id   JOIN ""order"" o ON o.id = op.orderid   WHERE o.ordertimestamp >= (SELECT MIN(o2.ordertimestamp) FROM ""order"" o2)     AND p.currentlyactive = TRUE   GROUP BY p.id, p.name )  SELECT * FROM ordered_products ORDER BY revenue_period DESC LIMIT 10;"
webshopdb,mistral-nemo,chain-of-thought,7,1275.907,1.324,0.218,37,1129.715,NaN,NaN,,0.0000139491,0.0000123481,1.129,False,False,"SELECT     c.id,     c.firstname,     c.lastname,     COUNT(o.id) AS num_orders FROM customer c JOIN ""order"" o ON o.customer = c.id GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(o.id) >= 5 ORDER BY num_orders DESC LIMIT 50","SELECT     c.id,     c.firstname,     c.lastname,     COUNT(o.id) AS num_orders FROM     customer c WHERE     EXISTS (         SELECT 1         FROM ""order"" o2         WHERE o2.customer = c.id AND COUNT(o2.id) >= 5     ) GROUP BY     c.id, c.firstname, c.lastname ORDER BY     num_orders DESC LIMIT 50"
webshopdb,mistral-nemo,chain-of-thought,8,1505.706,1.430,0.242,41,1286.951,NaN,NaN,,0.0000164617,0.0000140721,1.170,False,False,"SELECT     o.id AS order_id,     o.ordertimestamp,     c.id AS customer_id,     c.firstname,     c.lastname,     o.total,     o.shippingcost FROM ""order"" o JOIN customer c ON c.id = o.customer WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") ORDER BY o.ordertimestamp DESC LIMIT 500","WITH ordered_orders AS (   SELECT     o.id AS order_id,     o.ordertimestamp,     c.id AS customer_id,     c.firstname,     c.lastname,     o.total,     o.shippingcost   FROM ""order"" o   JOIN customer c ON c.id = o.customer   LIMIT 500 ) SELECT * FROM ordered_orders WHERE ordertimestamp >= (   SELECT MIN(ordertimestamp) OVER ()   FROM ordered_orders );"
webshopdb,mistral-nemo,chain-of-thought,9,1473.586,10.205,0.451,448,1267.360,0.058,0.410,4,0.0000160992,0.0000138515,1.163,False,False,"SELECT     p.category,     p.id AS product_id,     p.name AS product_name,     SUM(op.amount) AS total_qty FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") GROUP BY p.category, p.id, p.name ORDER BY p.category, total_qty DESC","WITH filtered_orders AS (   SELECT id, ordertimestamp   FROM ""order""   WHERE ordertimestamp >= '2022-01-01' -- Replace with the desired minimum timestamp ),  order_positions_with_amount AS (   SELECT op.id, op.articleid, op.amount   FROM order_positions op   JOIN filtered_orders fo ON fo.id = op.orderid )  SELECT   p.category,   p.id AS product_id,   p.name AS product_name,   SUM(op.amount) AS total_qty FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions_with_amount op ON op.articleid = a.id GROUP BY p.category, p.id, p.name ORDER BY p.category, total_qty DESC;"
webshopdb,mistral-nemo,chain-of-thought,10,1460.918,1.757,0.294,37,1366.450,1.393,0.239,37,0.0000159657,0.0000149324,1.069,False,False,"SELECT     c.id,     c.firstname,     c.lastname,     MAX(o.ordertimestamp) AS last_order_timestamp FROM customer c LEFT JOIN ""order"" o ON o.customer = c.id GROUP BY c.id, c.firstname, c.lastname HAVING MAX(o.ordertimestamp) < current_date - interval '6 months'     OR MAX(o.ordertimestamp) IS NULL ORDER BY last_order_timestamp NULLS FIRST LIMIT 200","SELECT     c.id,     c.firstname,     c.lastname,     MAX(o.ordertimestamp) AS last_order_timestamp FROM customer c LEFT JOIN LATERAL (   SELECT o.id, o.customer, o.ordertimestamp   FROM ""order"" o   WHERE o.customer = c.id AND o.ordertimestamp < '2022-07-01' -- Replace with the desired date ) o ON TRUE GROUP BY c.id, c.firstname, c.lastname HAVING MAX(o.ordertimestamp) IS NULL ORDER BY last_order_timestamp NULLS FIRST LIMIT 200"
webshopdb,mistral-nemo,chain-of-thought,11,1233.311,2.230,0.225,37,1276.706,3.478,0.234,37,0.0000134720,0.0000139521,0.966,True,False,"SELECT     c.id,     c.firstname,     c.lastname,     COUNT(o.id) AS num_orders,     SUM(o.total::numeric) AS total_spent,     AVG(o.total::numeric) AS avg_order_value FROM customer c JOIN ""order"" o ON o.customer = c.id GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(o.id) >= 3 ORDER BY avg_order_value DESC LIMIT 20;","WITH customer_orders AS (   SELECT     c.id,     c.firstname,     c.lastname,     COUNT(o.id) OVER (PARTITION BY c.id) AS num_orders,     SUM(o.total::numeric) OVER (PARTITION BY c.id) AS total_spent   FROM     customer c     JOIN ""order"" o ON o.customer = c.id ) SELECT   id,   firstname,   lastname,   num_orders,   total_spent,   CASE WHEN num_orders IS NULL THEN 0 ELSE total_spent::numeric / num_orders END AS avg_order_value FROM   customer_orders WHERE   num_orders >= 3 ORDER BY   avg_order_value DESC LIMIT 20;"
webshopdb,mistral-nemo,chain-of-thought,12,1341.264,20.950,0.412,538,1216.892,NaN,NaN,,0.0000146564,0.0000133894,1.102,False,False,"SELECT     p.id AS product_id,     p.name AS product_name,     COALESCE(SUM(s.count), 0) AS total_stock,     COALESCE(SUM(op.amount), 0) AS total_sold FROM products p JOIN articles a ON a.productid = p.id LEFT JOIN stock s ON s.articleid = a.id LEFT JOIN order_positions op ON op.articleid = a.id GROUP BY p.id, p.name HAVING COALESCE(SUM(s.count), 0) < 10   -- “baixo” estoque ORDER BY total_stock ASC, total_sold DESC;",CREATE INDEX idx_products_productid ON products(id);    CREATE INDEX idx_articles_productid ON articles(productid);    CREATE INDEX idx_stock_articleid ON stock(articleid);    CREATE INDEX idx_order_positions_articleid ON order_positions(articleid);
webshopdb,mistral-nemo,chain-of-thought,13,1280.506,14.140,0.359,444,1364.648,13.806,0.387,444,0.0000139970,0.0000149143,0.938,False,False,"SELECT     date_trunc('month', o.ordertimestamp) AS month,     p.category,     SUM(op.amount * op.price::numeric) AS revenue FROM ""order"" o JOIN order_positions op ON op.orderid = o.id JOIN articles a ON a.id = op.articleid JOIN products p ON p.id = a.productid GROUP BY month, p.category ORDER BY month, revenue DESC;","WITH monthly_revenue AS (   SELECT     EXTRACT(MONTH FROM o.ordertimestamp) AS month,     p.category,     SUM(op.amount * op.price::numeric) AS revenue   FROM ""order"" o   JOIN order_positions op ON op.orderid = o.id   JOIN articles a ON a.id = op.articleid   JOIN products p ON p.id = a.productid   GROUP BY month, p.category ) SELECT * FROM monthly_revenue ORDER BY month, revenue DESC;"
webshopdb,mistral-nemo,chain-of-thought,14,1596.698,13.357,0.479,462,1345.193,31.780,0.692,34555,0.0000174498,0.0000147016,1.187,False,False,"SELECT     c.id,     c.firstname,     c.lastname,     COUNT(DISTINCT p.category) AS categories_bought FROM customer c JOIN ""order"" o ON o.customer = c.id JOIN order_positions op ON op.orderid = o.id JOIN articles a ON a.id = op.articleid JOIN products p ON p.id = a.productid GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(DISTINCT p.category) >= 3 ORDER BY categories_bought DESC, c.id;","SELECT     c.id,     c.firstname,     c.lastname,     COUNT(DISTINCT p.category) AS categories_bought FROM customer c JOIN ""order"" o ON o.customer = c.id JOIN order_positions op ON op.orderid = o.id JOIN articles a ON a.id = op.articleid AND a.currentlyactive = TRUE JOIN products p ON p.id = a.productid AND p.currentlyactive = TRUE WHERE EXISTS (     SELECT 1     FROM stock s     JOIN articles a2 ON a2.id = op.articleid     WHERE s.articleid = a2.id AND s.count > 0 ) GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(DISTINCT p.category) >= 3 ORDER BY categories_bought DESC, c.id LIMIT 100;"
webshopdb,mistral-nemo,chain-of-thought,15,1447.890,12.251,0.595,566,1190.212,NaN,NaN,,0.0000157897,0.0000129846,1.216,False,False,"WITH bounds AS (     SELECT (SELECT MAX(ordertimestamp) FROM ""order"") AS max_ts ) SELECT     a.id AS article_id,     a.description,     p.name AS product_name,     COALESCE(SUM(s.count), 0) AS current_stock,     COUNT(DISTINCT o.id) AS num_orders_recent FROM articles a JOIN products p ON p.id = a.productid LEFT JOIN stock s ON s.articleid = a.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid CROSS JOIN bounds b WHERE o.ordertimestamp >= b.max_ts - interval '1 year' GROUP BY a.id, a.description, p.name HAVING COALESCE(SUM(s.count), 0) = 0 ORDER BY num_orders_recent DESC;","SELECT     a.id AS article_id,     a.description,     p.name AS product_name,     COALESCE(stock_sum, 0) AS current_stock,     COUNT(DISTINCT o.id) AS num_orders_recent FROM     articles a JOIN     products p ON p.id = a.productid LEFT JOIN LATERAL (     SELECT SUM(count)     FROM stock s     WHERE s.articleid = a.id ) stock_sum_lateral ON TRUE JOIN     order_positions op ON op.articleid = a.id AND o.ordertimestamp >= (SELECT MAX(ordertimestamp) FROM ""order"") - interval '1 year' JOIN     ""order"" o ON o.id = op.orderid WHERE     stock_sum_lateral IS NULL OR stock_sum_lateral > 0 GROUP BY     a.id,     a.description,     p.name,     stock_sum ORDER BY     num_orders_recent DESC;"
webshopdb,mistral-nemo,chain-of-thought,16,1310.945,6.863,0.219,425,1439.298,0.452,0.117,21,0.0000144355,0.0000157694,0.911,False,False,"SELECT     p.id,     p.name FROM products p WHERE p.id NOT IN (     SELECT DISTINCT a.productid     FROM articles a     JOIN order_positions op ON op.articleid = a.id );","SELECT     p.id,     p.name FROM products p LEFT JOIN (   SELECT DISTINCT articleid   FROM order_positions ) op ON p.id = op.articleid WHERE op.articleid IS NULL;"
webshopdb,mistral-nemo,chain-of-thought,17,1573.005,384.397,0.365,128697,1412.988,42.704,0.408,768,0.0000171036,0.0000154797,1.113,True,False,"SELECT     p.id,     p.name,     p.category,     a.reducedprice,     (         SELECT AVG(a2.reducedprice::numeric)         FROM articles a2         JOIN products p2 ON p2.id = a2.productid         WHERE p2.category = p.category     ) AS avg_category_price FROM products p JOIN articles a ON a.productid = p.id WHERE a.reducedprice::numeric > (     SELECT AVG(a3.reducedprice::numeric)     FROM articles a3     JOIN products p3 ON p3.id = a3.productid     WHERE p3.category = p.category ) LIMIT 50;","WITH category_avg_prices AS (   SELECT     p.category,     AVG(a.reducedprice::numeric) AS avg_price   FROM     products p     JOIN articles a ON a.productid = p.id   GROUP BY     p.category ) SELECT   p.id,   p.name,   p.category,   a.reducedprice,   ca.avg_price FROM   products p   JOIN articles a ON a.productid = p.id   JOIN category_avg_prices ca ON ca.category = p.category WHERE   EXISTS (     SELECT 1     FROM articles a3     JOIN products p3 ON p3.id = a3.productid     WHERE p3.category = p.category AND a3.reducedprice::numeric > a.reducedprice::numeric   ) LIMIT 50;"
webshopdb,mistral-nemo,chain-of-thought,18,1301.664,4.749,0.112,3921,1220.487,NaN,NaN,,0.0000142676,0.0000132536,1.067,False,False,"SELECT      c.id,      c.firstname,      c.lastname FROM customer c ORDER BY (     SELECT SUM(o.total::numeric)      FROM ""order"" o      WHERE o.customer = c.id ) DESC  LIMIT 50;","CREATE INDEX idx_orders_customer ON ""order"" (customer); CREATE INDEX idx_orders_total ON ""order"" (total);"
webshopdb,mistral-nemo,chain-of-thought,19,1519.546,1.811,0.101,2713,1309.734,NaN,NaN,,0.0000164737,0.0000143119,1.160,False,False,"SELECT      c.id,     c.firstname,     (SELECT COUNT(*) FROM ""order"" o WHERE o.customer = c.id) AS total_orders FROM customer c WHERE c.id < 1000;",CREATE INDEX IF NOT EXISTS idx_customer_id ON customer(id);
webshopdb,mistral-nemo,chain-of-thought,20,1464.140,0.888,0.062,19,1238.888,NaN,NaN,,0.0000159356,0.0000135868,1.182,False,False,"SELECT      o.id,     o.ordertimestamp,     o.total FROM ""order"" o WHERE EXTRACT(MONTH FROM o.ordertimestamp) = 12   AND o.total::numeric > 50;",CREATE INDEX IF NOT EXISTS idx_orders_ordertimestamp ON webshop.order(ordertimestamp);
webshopdb,mistral-nemo,chain-of-thought,21,1436.154,15.460,0.306,493,1376.366,15.957,0.326,493,0.0000157980,0.0000148835,1.043,False,False,"SELECT     p.id AS product_id,     p.name AS product_name,     COALESCE(SUM(s.count), 0) AS total_stock FROM products p LEFT JOIN articles a ON a.productid = p.id LEFT JOIN stock s ON s.articleid = a.id GROUP BY p.id, p.name ORDER BY total_stock DESC;","SELECT     p.id AS product_id,     p.name AS product_name,     COALESCE(SUM(s.count), 0) AS total_stock FROM     products p LEFT JOIN     articles a ON a.productid = p.id AND a.currentlyactive = TRUE LEFT JOIN     stock s ON s.articleid = a.id WHERE     p.currentlyactive = TRUE GROUP BY     p.id, p.name ORDER BY     total_stock DESC LIMIT 100;"
webshopdb,mistral-nemo,chain-of-thought,22,1202.049,0.231,0.076,18,1240.657,NaN,NaN,,0.0000130877,0.0000135975,0.969,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     c.email,     c.created FROM customer c WHERE c.created >= CURRENT_DATE - INTERVAL '30 days' ORDER BY c.created DESC;",CREATE INDEX IF NOT EXISTS idx_customer_created ON customer(created);
webshopdb,mistral-nemo,chain-of-thought,23,1246.796,8.917,0.326,425,1196.333,0.999,0.371,45,0.0000136928,0.0000131283,1.042,False,False,"SELECT     p.id AS product_id,     p.name AS product_name,     SUM(op.amount) AS total_sold FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 20;","SELECT     p.id AS product_id,     p.name AS product_name,     SUM(op.amount) AS total_sold FROM     products p JOIN     articles a ON a.productid = p.id AND p.currentlyactive = true JOIN     order_positions op ON op.articleid = a.id WHERE     op.created >= (CURRENT_DATE - INTERVAL '1 year') GROUP BY     p.id, p.name ORDER BY     total_sold DESC LIMIT 20 OFFSET 0;"
webshopdb,mistral-nemo,chain-of-thought,24,1223.236,0.077,0.606,4,1212.354,NaN,NaN,,0.0000134695,0.0000133138,1.009,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     COUNT(DISTINCT p.category) AS categories_bought FROM customer c JOIN ""order"" o ON o.customer = c.id JOIN order_positions op ON op.orderid = o.id JOIN articles a ON a.id = op.articleid JOIN products p ON p.id = a.productid WHERE o.ordertimestamp >= CURRENT_DATE - INTERVAL '6 months' GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(DISTINCT p.category) >= 4 ORDER BY categories_bought DESC;","WITH filtered_orders AS (   SELECT id, customer   FROM ""order""   WHERE ordertimestamp >= CURRENT_DATE - INTERVAL '6 months' ), customer_orders AS (   SELECT c.id AS customer_id, c.firstname, c.lastname,          COUNT(DISTINCT FILTER (WHERE p.category IS NOT NULL)) OVER (PARTITION BY c.id) AS categories_bought   FROM customer c   JOIN filtered_orders fo ON fo.customer = c.id   JOIN order_positions op ON op.orderid = fo.id   JOIN articles a ON a.id = op.articleid   JOIN products p ON p.id = a.productid ) SELECT customer_id, firstname, lastname FROM customer_orders WHERE categories_bought >= 4 ORDER BY categories_bought DESC;"
webshopdb,mistral-nemo,chain-of-thought,25,1184.682,21.328,0.322,520,1125.203,NaN,NaN,,0.0000130683,0.0000123516,1.053,False,False,"WITH stats AS (     SELECT         a.id AS article_id,         a.description,         SUM(op.amount) AS total_sold,         COALESCE(SUM(s.count), 0) AS current_stock     FROM articles a     LEFT JOIN stock s ON s.articleid = a.id     JOIN order_positions op ON op.articleid = a.id     GROUP BY a.id, a.description ) SELECT     article_id,     description,     total_sold,     current_stock,     (total_sold * 1.0 / NULLIF(current_stock, 0)) AS demand_index FROM stats ORDER BY demand_index DESC NULLS LAST LIMIT 10;","WITH RECURSIVE stats AS (   SELECT     a.id AS article_id,     a.description,     SUM(op.amount) AS total_sold,     COALESCE(SUM(s.count), 0) AS current_stock,     NULLIF(current_stock, 0) AS stock_for_demand_index   FROM articles a   LEFT JOIN stock s ON s.articleid = a.id   JOIN order_positions op ON op.articleid = a.id AND op.orderid IN (     SELECT id FROM orders WHERE shippingaddressid IS NOT NULL   )   WHERE a.currentlyactive = TRUE AND op.price > 0   GROUP BY a.id, a.description ) SELECT   article_id,   description,   total_sold,   current_stock,   (total_sold / stock_for_demand_index) AS demand_index FROM stats ORDER BY demand_index DESC NULLS LAST LIMIT 10;"
