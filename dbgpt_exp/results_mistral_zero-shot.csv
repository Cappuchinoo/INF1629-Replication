db,query_id,original_ms,execution_ms_original,planning_ms_original,buffers_plan_original,rewritten_ms,execution_ms_rewritten,planning_ms_rewritten,buffers_plan_rewritten,emissions_original,emissions_rewritten,speedup,buffers_ratio,same_rowcount,same_signature,original_sql,rewritten_sql
webshopdb,1,1770.359,9.308,0.164,10828,1796.832,7.973,0.128,7828,1.167,1.383,2.1019541739793196e-05,2.135630913913365e-05,True,True,"SELECT     c.id AS customer_id,     (SELECT c2.firstname || ' ' || c2.lastname      FROM customer c2      WHERE c2.id = c.id) AS full_name,     (       SELECT SUM(o.total::numeric)       FROM ""order"" o       WHERE o.customer = c.id         AND date_trunc('year', o.ordertimestamp) = (             SELECT date_trunc('year', MIN(ordertimestamp)) FROM ""order""         )     ) AS total_spent_last_year FROM customer c WHERE c.email IS NOT NULL    -- substitui o filtro impossível ORDER BY     (SELECT SUM(o2.total::numeric)      FROM ""order"" o2      WHERE o2.customer = c.id) DESC","SELECT     c.id AS customer_id,     c.firstname || ' ' || c.lastname AS full_name,     (       SELECT SUM(o.total::numeric)       FROM ""order"" o       WHERE o.customer = c.id         AND date_trunc('year', o.ordertimestamp) = (             SELECT date_trunc('year', MIN(ordertimestamp)) FROM ""order""         )     ) AS total_spent_last_year FROM customer c WHERE c.email IS NOT NULL ORDER BY     (SELECT SUM(o2.total::numeric)      FROM ""order"" o2      WHERE o2.customer = c.id) DESC"
webshopdb,2,2214.055,12.978,0.525,449,2273.571,12.946,0.498,449,1.002,1.000,2.6696436396399143e-05,2.7259249003804427e-05,True,False,"SELECT DISTINCT     a.id AS article_id,     p.name AS product_name,     a.originalprice,     a.reducedprice,     c.name AS color_name,     random() AS rnd FROM articles a JOIN products p ON p.id = a.productid JOIN colors c ON c.id = a.colorid JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"")   AND p.name IS NOT NULL       -- substitui o filtro impossível ORDER BY rnd","SELECT DISTINCT     a.id AS article_id,     p.name AS product_name,     a.originalprice,     a.reducedprice,     c.name AS color_name,     random() AS rnd FROM articles a JOIN products p ON p.id = a.productid JOIN colors c ON c.id = a.colorid JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"" WHERE id IS NOT NULL)   AND p.name IS NOT NULL ORDER BY rnd"
webshopdb,3,1754.167,3.397,0.214,82,1777.928,3.397,0.260,82,1.000,1.000,2.1483434043337595e-05,2.105541952430362e-05,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     c.email FROM customer c WHERE c.id IN (     SELECT DISTINCT o.customer     FROM ""order"" o     JOIN order_positions op ON op.orderid = o.id     WHERE op.amount >= 1 )","SELECT c.id, c.firstname, c.lastname, c.email FROM customer c WHERE EXISTS (     SELECT 1     FROM ""order"" o     JOIN order_positions op ON op.orderid = o.id     WHERE op.amount >= 1 AND o.customer = c.id )"
webshopdb,4,1888.875,1.801,0.252,41,1935.676,1.905,0.245,41,0.945,1.000,2.284835262888704e-05,2.3492159904644062e-05,True,True,"SELECT DISTINCT     c.id,     c.firstname,     c.lastname,     o.id AS order_id,     o.ordertimestamp FROM customer c LEFT JOIN ""order"" o ON o.customer = c.id WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") ORDER BY o.ordertimestamp DESC","SELECT DISTINCT c.id, c.firstname, c.lastname, o.id AS order_id, o.ordertimestamp FROM customer c LEFT JOIN ""order"" o ON o.customer = c.id WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") ORDER BY o.ordertimestamp DESC"
webshopdb,5,1762.624,5.175,0.226,3676,1767.243,3.413,0.295,56,1.516,65.643,2.1397420918631193e-05,2.1608513103651775e-05,True,False,"SELECT     c.id,     c.firstname,     c.lastname,     (         SELECT SUM(o.total::numeric)         FROM ""order"" o         WHERE o.customer = c.id     ) AS total_spent FROM customer c WHERE c.id IN (SELECT customer FROM ""order"") ORDER BY total_spent DESC NULLS LAST","SELECT c.id, c.firstname, c.lastname, COALESCE(SUM(o.total::numeric), 0) AS total_spent FROM customer c LEFT JOIN ""order"" o ON o.customer = c.id WHERE EXISTS (SELECT 1 FROM ""order"" o2 WHERE o2.customer = c.id) GROUP BY c.id, c.firstname, c.lastname ORDER BY total_spent DESC NULLS LAST"
webshopdb,6,1434.659,11.853,0.544,448,nan,,,,,,1.7360666791238875e-05,nan,False,False,"SELECT     p.id AS product_id,     p.name AS product_name,     SUM(op.amount * op.price::numeric) AS revenue_period FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"")   AND p.currentlyactive = TRUE GROUP BY p.id, p.name ORDER BY revenue_period DESC LIMIT 10","SELECT p.id AS product_id, p.name AS product_name, SUM(op.amount * op.price::numeric) AS revenue_period FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") AND p.currentlyactive = TRUE GROUP BY p.id, p.name ORDER BY revenue_period DESC LIMIT 10"
webshopdb,7,1577.835,1.322,0.223,37,1614.922,1.295,0.250,37,1.021,1.000,1.9187584723481894e-05,1.9840259683227656e-05,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     COUNT(o.id) AS num_orders FROM customer c JOIN ""order"" o ON o.customer = c.id GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(o.id) >= 5 ORDER BY num_orders DESC LIMIT 50","SELECT c.id, c.firstname, c.lastname, COUNT(o.id) AS num_orders FROM customer c JOIN ""order"" o ON o.customer = c.id GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(o.id) >= 5 ORDER BY num_orders DESC LIMIT 50"
webshopdb,8,1788.617,1.504,0.245,41,1739.501,1.537,0.258,41,0.979,1.000,2.1871900802752023e-05,2.1486138224523597e-05,True,True,"SELECT     o.id AS order_id,     o.ordertimestamp,     c.id AS customer_id,     c.firstname,     c.lastname,     o.total,     o.shippingcost FROM ""order"" o JOIN customer c ON c.id = o.customer WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") ORDER BY o.ordertimestamp DESC LIMIT 500","SELECT o.id AS order_id, o.ordertimestamp, c.id AS customer_id, c.firstname, c.lastname, o.total, o.shippingcost FROM ""order"" o JOIN customer c ON c.id = o.customer WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"" LIMIT 1) ORDER BY o.ordertimestamp DESC LIMIT 500"
webshopdb,9,1784.225,9.904,0.440,448,nan,,,,,,2.169168309382931e-05,nan,False,False,"SELECT     p.category,     p.id AS product_id,     p.name AS product_name,     SUM(op.amount) AS total_qty FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") GROUP BY p.category, p.id, p.name ORDER BY p.category, total_qty DESC","SELECT p.category, p.id AS product_id, p.name AS product_name, SUM(op.amount) AS total_qty FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") GROUP BY p.category, p.id, p.name ORDER BY p.category, total_qty DESC"
webshopdb,10,1565.143,1.786,0.227,37,1579.857,1.952,0.243,37,0.915,1.000,1.9053197585795204e-05,1.9208743904588998e-05,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     MAX(o.ordertimestamp) AS last_order_timestamp FROM customer c LEFT JOIN ""order"" o ON o.customer = c.id GROUP BY c.id, c.firstname, c.lastname HAVING MAX(o.ordertimestamp) < current_date - interval '6 months'     OR MAX(o.ordertimestamp) IS NULL ORDER BY last_order_timestamp NULLS FIRST LIMIT 200","SELECT c.id, c.firstname, c.lastname, MAX(o.ordertimestamp) AS last_order_timestamp FROM customer c LEFT JOIN ""order"" o ON o.customer = c.id WHERE o.ordertimestamp < current_date - interval '6 months' OR o.ordertimestamp IS NULL GROUP BY c.id, c.firstname, c.lastname ORDER BY last_order_timestamp NULLS FIRST LIMIT 200"
webshopdb,11,1439.108,2.282,0.222,37,1429.026,3.263,0.395,56,0.699,0.661,1.7379623636591926e-05,1.7353356034613773e-05,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     COUNT(o.id) AS num_orders,     SUM(o.total::numeric) AS total_spent,     AVG(o.total::numeric) AS avg_order_value FROM customer c JOIN ""order"" o ON o.customer = c.id GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(o.id) >= 3 ORDER BY avg_order_value DESC LIMIT 20;","SELECT c.id, c.firstname, c.lastname, COUNT(o.id) AS num_orders, SUM(o.total::numeric) AS total_spent, AVG(o.total::numeric) AS avg_order_value FROM customer c JOIN ""order"" o ON o.customer = c.id WHERE EXISTS (SELECT 1 FROM ""order"" o2 WHERE o2.customer = c.id) GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(o.id) >= 3 ORDER BY avg_order_value DESC LIMIT 20;"
webshopdb,12,1459.394,23.557,0.541,538,1423.990,25.817,0.425,538,0.912,1.000,1.7846048339987186e-05,1.7361843532838057e-05,True,True,"SELECT     p.id AS product_id,     p.name AS product_name,     COALESCE(SUM(s.count), 0) AS total_stock,     COALESCE(SUM(op.amount), 0) AS total_sold FROM products p JOIN articles a ON a.productid = p.id LEFT JOIN stock s ON s.articleid = a.id LEFT JOIN order_positions op ON op.articleid = a.id GROUP BY p.id, p.name HAVING COALESCE(SUM(s.count), 0) < 10   -- “baixo” estoque ORDER BY total_stock ASC, total_sold DESC;","SELECT     p.id AS product_id,     p.name AS product_name,     COALESCE(SUM(s.count), 0) AS total_stock,     COALESCE(SUM(op.amount), 0) AS total_sold FROM products p JOIN articles a ON a.productid = p.id LEFT JOIN LATERAL (     SELECT count FROM stock WHERE articleid = a.id ) s ON true LEFT JOIN LATERAL (     SELECT amount FROM order_positions WHERE articleid = a.id ) op ON true GROUP BY p.id, p.name HAVING COALESCE(SUM(s.count), 0) < 10 ORDER BY total_stock ASC, total_sold DESC;"
webshopdb,13,1602.717,18.238,0.357,444,1634.315,13.598,0.372,444,1.341,1.000,1.969588540498503e-05,2.0117594133075234e-05,True,True,"SELECT     date_trunc('month', o.ordertimestamp) AS month,     p.category,     SUM(op.amount * op.price::numeric) AS revenue FROM ""order"" o JOIN order_positions op ON op.orderid = o.id JOIN articles a ON a.id = op.articleid JOIN products p ON p.id = a.productid GROUP BY month, p.category ORDER BY month, revenue DESC;","SELECT     date_trunc('month', o.ordertimestamp) AS month,     p.category,     SUM(op.amount * op.price::numeric) AS revenue FROM ""order"" o JOIN order_positions op ON op.orderid = o.id JOIN articles a ON a.id = op.articleid JOIN products p ON p.id = a.productid GROUP BY 1, 2 ORDER BY 1, 3 DESC;"
webshopdb,14,1775.676,13.820,0.507,462,3047.160,1607.315,1.040,400731,0.009,0.001,2.179926961676864e-05,3.624871446395883e-05,False,False,"SELECT     c.id,     c.firstname,     c.lastname,     COUNT(DISTINCT p.category) AS categories_bought FROM customer c JOIN ""order"" o ON o.customer = c.id JOIN order_positions op ON op.orderid = o.id JOIN articles a ON a.id = op.articleid JOIN products p ON p.id = a.productid GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(DISTINCT p.category) >= 3 ORDER BY categories_bought DESC, c.id;","SELECT c.id, c.firstname, c.lastname, COUNT(DISTINCT p.category) AS categories_bought FROM customer c JOIN ""order"" o ON o.customer = c.id JOIN order_positions op ON op.orderid = o.id JOIN articles a ON a.id = op.articleid JOIN products p ON p.id = a.productid WHERE EXISTS (SELECT 1 FROM order_positions op2 JOIN articles a2 ON op2.articleid = a2.id JOIN products p2 ON a2.productid = p2.id WHERE op2.orderid = o.id AND p2.category IN (SELECT p3.category FROM order_positions op3 JOIN articles a3 ON op3.articleid = a3.id JOIN products p3 ON a3.productid = p3.id WHERE op3.orderid = o.id GROUP BY p3.category HAVING COUNT(DISTINCT p3.category) >= 2)) GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(DISTINCT p.category) >= 3 ORDER BY categories_bought DESC, c.id;"
webshopdb,15,1710.051,11.596,0.618,566,1759.085,11.886,0.586,566,0.976,1.000,2.03400451921766e-05,2.0926826376331797e-05,True,True,"WITH bounds AS (     SELECT (SELECT MAX(ordertimestamp) FROM ""order"") AS max_ts ) SELECT     a.id AS article_id,     a.description,     p.name AS product_name,     COALESCE(SUM(s.count), 0) AS current_stock,     COUNT(DISTINCT o.id) AS num_orders_recent FROM articles a JOIN products p ON p.id = a.productid LEFT JOIN stock s ON s.articleid = a.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid CROSS JOIN bounds b WHERE o.ordertimestamp >= b.max_ts - interval '1 year' GROUP BY a.id, a.description, p.name HAVING COALESCE(SUM(s.count), 0) = 0 ORDER BY num_orders_recent DESC;","SELECT     a.id AS article_id,     a.description,     p.name AS product_name,     COALESCE(SUM(s.count), 0) AS current_stock,     COUNT(DISTINCT o.id) AS num_orders_recent FROM articles a JOIN products p ON p.id = a.productid LEFT JOIN stock s ON s.articleid = a.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MAX(ordertimestamp) FROM ""order"") - interval '1 year' GROUP BY a.id, a.description, p.name HAVING COALESCE(SUM(s.count), 0) = 0 ORDER BY num_orders_recent DESC;"
webshopdb,16,1626.254,6.888,0.220,425,1608.912,6.618,0.229,425,1.041,1.000,1.9954544651453166e-05,1.911053535323376e-05,True,True,"SELECT     p.id,     p.name FROM products p WHERE p.id NOT IN (     SELECT DISTINCT a.productid     FROM articles a     JOIN order_positions op ON op.articleid = a.id );","SELECT p.id, p.name FROM products p WHERE NOT EXISTS (SELECT 1 FROM articles a JOIN order_positions op ON op.articleid = a.id WHERE a.productid = p.id)"
webshopdb,17,1856.078,390.250,0.374,128697,1599.828,9.777,0.304,388,39.915,331.693,2.205628836463594e-05,1.9047598082784326e-05,True,True,"SELECT     p.id,     p.name,     p.category,     a.reducedprice,     (         SELECT AVG(a2.reducedprice::numeric)         FROM articles a2         JOIN products p2 ON p2.id = a2.productid         WHERE p2.category = p.category     ) AS avg_category_price FROM products p JOIN articles a ON a.productid = p.id WHERE a.reducedprice::numeric > (     SELECT AVG(a3.reducedprice::numeric)     FROM articles a3     JOIN products p3 ON p3.id = a3.productid     WHERE p3.category = p.category ) LIMIT 50;","SELECT p.id, p.name, p.category, a.reducedprice, c.avg_price AS avg_category_price FROM products p JOIN articles a ON a.productid = p.id JOIN (     SELECT p2.category, AVG(a2.reducedprice::numeric) AS avg_price     FROM articles a2     JOIN products p2 ON p2.id = a2.productid     GROUP BY p2.category ) c ON c.category = p.category WHERE a.reducedprice::numeric > c.avg_price LIMIT 50;"
webshopdb,18,1624.846,4.223,0.110,3921,1603.754,2.049,0.178,352,2.061,11.139,1.930813510811421e-05,1.906617064297847e-05,True,False,"SELECT      c.id,      c.firstname,      c.lastname FROM customer c ORDER BY (     SELECT SUM(o.total::numeric)      FROM ""order"" o      WHERE o.customer = c.id ) DESC  LIMIT 50;","SELECT c.id, c.firstname, c.lastname FROM customer c WHERE c.id IN (     SELECT o.customer     FROM ""order"" o     GROUP BY o.customer     ORDER BY SUM(o.total::numeric) DESC     LIMIT 50 ) ORDER BY (     SELECT SUM(o.total::numeric)     FROM ""order"" o     WHERE o.customer = c.id ) DESC;"
webshopdb,19,1742.840,1.862,0.102,2713,1742.355,1.846,0.115,2713,1.009,1.000,2.0739218081381962e-05,2.0754357209839075e-05,True,True,"SELECT      c.id,     c.firstname,     (SELECT COUNT(*) FROM ""order"" o WHERE o.customer = c.id) AS total_orders FROM customer c WHERE c.id < 1000;","SELECT c.id, c.firstname, (SELECT COUNT(*) FROM ""order"" WHERE customer = c.id) AS total_orders FROM customer c WHERE c.id < 1000;"
webshopdb,20,1618.626,0.887,0.063,19,nan,,,,,,1.959401156070515e-05,nan,False,False,"SELECT      o.id,     o.ordertimestamp,     o.total FROM ""order"" o WHERE EXTRACT(MONTH FROM o.ordertimestamp) = 12   AND o.total::numeric > 50;","SELECT o.id, o.ordertimestamp, o.total FROM ""order"" o WHERE o.ordertimestamp >= '2000-12-01'::date AND o.ordertimestamp < '2001-01-01'::date AND o.total > 50::numeric;"
webshopdb,21,1767.072,15.405,0.352,493,nan,,,,,,2.1013440555157432e-05,nan,False,False,"SELECT     p.id AS product_id,     p.name AS product_name,     COALESCE(SUM(s.count), 0) AS total_stock FROM products p LEFT JOIN articles a ON a.productid = p.id LEFT JOIN stock s ON s.articleid = a.id GROUP BY p.id, p.name ORDER BY total_stock DESC;","SELECT p.id AS product_id, p.name AS product_name, COALESCE(SUM(s.count), 0) AS total_stock FROM products p LEFT JOIN LATERAL (SELECT a.id, s.count FROM articles a LEFT JOIN stock s ON s.articleid = a.id WHERE a.productid = p.id) AS subq ON true GROUP BY p.id, p.name ORDER BY total_stock DESC;"
webshopdb,22,1443.744,0.034,0.086,1,1426.088,0.028,0.085,1,1.214,1.000,1.727332176726548e-05,1.6971910245585738e-05,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     c.email,     c.created FROM customer c WHERE c.created >= CURRENT_DATE - INTERVAL '30 days' ORDER BY c.created DESC;","SELECT c.id, c.firstname, c.lastname, c.email, c.created FROM customer c WHERE c.created >= (CURRENT_DATE - INTERVAL '30 days') ORDER BY c.created DESC;"
webshopdb,23,1438.927,8.123,0.349,425,1460.081,8.237,0.322,425,0.986,1.000,1.708672579745449e-05,1.7370897176548424e-05,True,True,"SELECT     p.id AS product_id,     p.name AS product_name,     SUM(op.amount) AS total_sold FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 20;","SELECT     p.id AS product_id,     p.name AS product_name,     SUM(op.amount) AS total_sold FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 20;"
webshopdb,24,1406.345,0.069,0.515,4,1451.893,0.071,0.527,4,0.972,1.000,1.7185415306656255e-05,1.766371462426431e-05,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     COUNT(DISTINCT p.category) AS categories_bought FROM customer c JOIN ""order"" o ON o.customer = c.id JOIN order_positions op ON op.orderid = o.id JOIN articles a ON a.id = op.articleid JOIN products p ON p.id = a.productid WHERE o.ordertimestamp >= CURRENT_DATE - INTERVAL '6 months' GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(DISTINCT p.category) >= 4 ORDER BY categories_bought DESC;","SELECT     c.id,     c.firstname,     c.lastname,     COUNT(DISTINCT p.category) AS categories_bought FROM customer c JOIN ""order"" o ON o.customer = c.id JOIN order_positions op ON op.orderid = o.id JOIN articles a ON a.id = op.articleid JOIN products p ON p.id = a.productid WHERE o.ordertimestamp >= (CURRENT_DATE - INTERVAL '6 months')::DATE GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(DISTINCT p.category) >= 4 ORDER BY categories_bought DESC;"
webshopdb,25,1557.083,17.394,0.327,520,1490.937,17.826,0.349,520,0.976,1.000,1.9000836480497835e-05,1.8210301051428575e-05,True,True,"WITH stats AS (     SELECT         a.id AS article_id,         a.description,         SUM(op.amount) AS total_sold,         COALESCE(SUM(s.count), 0) AS current_stock     FROM articles a     LEFT JOIN stock s ON s.articleid = a.id     JOIN order_positions op ON op.articleid = a.id     GROUP BY a.id, a.description ) SELECT     article_id,     description,     total_sold,     current_stock,     (total_sold * 1.0 / NULLIF(current_stock, 0)) AS demand_index FROM stats ORDER BY demand_index DESC NULLS LAST LIMIT 10;","SELECT article_id, description, total_sold, current_stock, (total_sold * 1.0 / NULLIF(current_stock, 0)) AS demand_index FROM (SELECT a.id AS article_id, a.description, SUM(op.amount) AS total_sold, COALESCE(SUM(s.count), 0) AS current_stock FROM articles a LEFT JOIN stock s ON s.articleid = a.id JOIN order_positions op ON op.articleid = a.id GROUP BY a.id, a.description) AS stats ORDER BY demand_index DESC NULLS LAST LIMIT 10;"
