db,llm,prompt_technique,query_id,original_ms,execution_ms_original,planning_ms_original,buffers_plan_original,rewritten_ms,execution_ms_rewritten,planning_ms_rewritten,buffers_plan_rewritten,emissions_original,emissions_rewritten,speedup,same_rowcount,same_signature,original_sql,rewritten_sql
webshopdb,mistral-nemo,zero-shot,1,2113.727,9.726,0.179,10828,1312.598,NaN,NaN,,0.0000231027,0.0000143482,1.610,False,False,"SELECT     c.id AS customer_id,     (SELECT c2.firstname || ' ' || c2.lastname      FROM customer c2      WHERE c2.id = c.id) AS full_name,     (       SELECT SUM(o.total::numeric)       FROM ""order"" o       WHERE o.customer = c.id         AND date_trunc('year', o.ordertimestamp) = (             SELECT date_trunc('year', MIN(ordertimestamp)) FROM ""order""         )     ) AS total_spent_last_year FROM customer c WHERE c.email IS NOT NULL    -- substitui o filtro impossível ORDER BY     (SELECT SUM(o2.total::numeric)      FROM ""order"" o2      WHERE o2.customer = c.id) DESC","CREATE INDEX IF NOT EXISTS idx_customer_email ON webshop.customer(email); CREATE INDEX IF NOT EXISTS idx_order_customer ON webshop.order(customer); CREATE INDEX IF NOT EXISTS idx_order_ordertimestamp ON webshop.order(ordertimestamp);  WITH RECURSIVE cte AS (   SELECT     id AS customer_id,     firstname || ' ' || lastname AS full_name,     MIN(o.ordertimestamp) OVER () AS min_order_timestamp   FROM     webshop.customer c   WHERE     email IS NOT NULL    UNION ALL    SELECT     o.customer AS customer_id,     NULL AS full_name,     NULL AS min_order_timestamp   FROM     webshop.order o ) SELECT   cte.customer_id,   cte.full_name,   COALESCE(SUM(o.total::numeric), 0) AS total_spent_last_year FROM   cte LEFT JOIN LATERAL (   SELECT     SUM(total::numeric) AS total_spent   FROM     webshop.order o2   WHERE     o2.customer = cte.customer_id AND     date_trunc('year', o2.ordertimestamp) >= date_trunc('year', cte.min_order_timestamp) ) AS o ON TRUE GROUP BY   cte.customer_id,   cte.full_name ORDER BY   total_spent_last_year DESC;"
webshopdb,mistral-nemo,zero-shot,2,2166.163,13.114,0.482,449,1830.881,14.322,0.619,449,0.0000236766,0.0000198725,1.183,True,False,"SELECT DISTINCT     a.id AS article_id,     p.name AS product_name,     a.originalprice,     a.reducedprice,     c.name AS color_name,     random() AS rnd FROM articles a JOIN products p ON p.id = a.productid JOIN colors c ON c.id = a.colorid JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"")   AND p.name IS NOT NULL       -- substitui o filtro impossível ORDER BY rnd","WITH filtered_orders AS (   SELECT id, ordertimestamp   FROM ""order""   WHERE ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") ) SELECT DISTINCT   a.id AS article_id,   p.name AS product_name,   a.originalprice,   a.reducedprice,   c.name AS color_name,   random() AS rnd FROM articles a JOIN products p ON p.id = a.productid AND p.name IS NOT NULL JOIN colors c ON c.id = a.colorid JOIN order_positions op ON op.articleid = a.id JOIN filtered_orders fo ON fo.id = op.orderid ORDER BY rnd;"
webshopdb,mistral-nemo,zero-shot,3,1564.901,3.419,0.214,82,1458.831,3.626,0.261,82,0.0000171043,0.0000159476,1.073,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     c.email FROM customer c WHERE c.id IN (     SELECT DISTINCT o.customer     FROM ""order"" o     JOIN order_positions op ON op.orderid = o.id     WHERE op.amount >= 1 )","SELECT     c.id,     c.firstname,     c.lastname,     c.email FROM customer c WHERE EXISTS (     SELECT 1     FROM ""order"" o     JOIN order_positions op ON op.orderid = o.id     WHERE o.customer = c.id AND op.amount >= 1 )"
webshopdb,mistral-nemo,zero-shot,4,1572.660,1.827,0.247,41,1454.174,0.923,0.197,21,0.0000171880,0.0000158918,1.081,False,False,"SELECT DISTINCT     c.id,     c.firstname,     c.lastname,     o.id AS order_id,     o.ordertimestamp FROM customer c LEFT JOIN ""order"" o ON o.customer = c.id WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") ORDER BY o.ordertimestamp DESC","WITH latest_orders AS (   SELECT id, customer, ordertimestamp   FROM ""order""   ORDER BY ordertimestamp DESC   LIMIT 1 ) SELECT DISTINCT     c.id,     c.firstname,     c.lastname,     o.id AS order_id,     o.ordertimestamp FROM customer c LEFT JOIN latest_orders o ON o.customer = c.id ORDER BY o.ordertimestamp DESC;"
webshopdb,mistral-nemo,zero-shot,5,1403.048,4.968,0.233,3676,1347.837,3.328,0.290,56,0.0000154140,0.0000146563,1.041,True,False,"SELECT     c.id,     c.firstname,     c.lastname,     (         SELECT SUM(o.total::numeric)         FROM ""order"" o         WHERE o.customer = c.id     ) AS total_spent FROM customer c WHERE c.id IN (SELECT customer FROM ""order"") ORDER BY total_spent DESC NULLS LAST","WITH order_customers AS (   SELECT DISTINCT customer   FROM ""order"" ), spending AS (   SELECT     c.id,     c.firstname,     c.lastname,     SUM(o.total::numeric) AS total_spent   FROM customer c   JOIN order_customers oc ON c.id = oc.customer   JOIN ""order"" o ON c.id = o.customer   GROUP BY c.id, c.firstname, c.lastname ) SELECT id, firstname, lastname, total_spent FROM spending ORDER BY total_spent DESC NULLS LAST;"
webshopdb,mistral-nemo,zero-shot,6,1258.540,11.644,0.503,448,1141.187,NaN,NaN,,0.0000136963,0.0000125039,1.103,False,False,"SELECT     p.id AS product_id,     p.name AS product_name,     SUM(op.amount * op.price::numeric) AS revenue_period FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"")   AND p.currentlyactive = TRUE GROUP BY p.id, p.name ORDER BY revenue_period DESC LIMIT 10","WITH active_products AS (   SELECT id, name   FROM products   WHERE currentlyactive = TRUE ), ordered_articles AS (   SELECT articleid, amount, price::numeric * amount AS revenue   FROM order_positions   JOIN ""order"" ON id = orderid   WHERE ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") ) SELECT   p.id AS product_id,   p.name AS product_name,   SUM(o.revenue) AS revenue_period FROM active_products p JOIN articles a ON a.productid = p.id JOIN ordered_articles o ON o.articleid = a.id GROUP BY p.id, p.name ORDER BY revenue_period DESC LIMIT 10;"
webshopdb,mistral-nemo,zero-shot,7,1336.047,1.529,0.220,37,1269.437,3.690,0.259,5228,0.0000145922,0.0000137731,1.052,True,False,"SELECT     c.id,     c.firstname,     c.lastname,     COUNT(o.id) AS num_orders FROM customer c JOIN ""order"" o ON o.customer = c.id GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(o.id) >= 5 ORDER BY num_orders DESC LIMIT 50","SELECT     c.id,     c.firstname,     c.lastname,     COUNT(o.id) AS num_orders FROM customer c JOIN ""order"" o ON o.customer = c.id WHERE EXISTS (     SELECT 1 FROM ""order"" WHERE customer = c.id GROUP BY customer HAVING COUNT(*) >= 5 ) GROUP BY c.id, c.firstname, c.lastname ORDER BY num_orders DESC LIMIT 50"
webshopdb,mistral-nemo,zero-shot,8,1398.649,1.491,0.264,41,1509.988,0.693,0.231,497,0.0000153864,0.0000163971,0.926,True,True,"SELECT     o.id AS order_id,     o.ordertimestamp,     c.id AS customer_id,     c.firstname,     c.lastname,     o.total,     o.shippingcost FROM ""order"" o JOIN customer c ON c.id = o.customer WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") ORDER BY o.ordertimestamp DESC LIMIT 500","WITH latest_orders AS (   SELECT id, ordertimestamp, customer, total, shippingcost   FROM ""order""   WHERE ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"")   ORDER BY ordertimestamp DESC   LIMIT 500 ) SELECT   o.id AS order_id,   o.ordertimestamp,   c.id AS customer_id,   c.firstname,   c.lastname,   o.total,   o.shippingcost FROM latest_orders o JOIN customer c ON c.id = o.customer;"
webshopdb,mistral-nemo,zero-shot,9,1574.366,9.670,0.473,448,1433.879,9.166,0.446,448,0.0000172966,0.0000156078,1.098,True,True,"SELECT     p.category,     p.id AS product_id,     p.name AS product_name,     SUM(op.amount) AS total_qty FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid WHERE o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"") GROUP BY p.category, p.id, p.name ORDER BY p.category, total_qty DESC","WITH ordered_products AS (   SELECT     p.category,     p.id AS product_id,     p.name AS product_name,     SUM(op.amount) AS total_qty   FROM     products p     JOIN articles a ON a.productid = p.id     JOIN order_positions op ON op.articleid = a.id     JOIN ""order"" o ON o.id = op.orderid   WHERE     o.ordertimestamp >= (SELECT MIN(ordertimestamp) FROM ""order"")   GROUP BY     p.category,     p.id,     p.name ) SELECT * FROM ordered_products ORDER BY   category,   total_qty DESC;"
webshopdb,mistral-nemo,zero-shot,10,1380.574,1.768,0.260,37,1382.532,1.888,0.249,37,0.0000150359,0.0000152532,0.999,True,False,"SELECT     c.id,     c.firstname,     c.lastname,     MAX(o.ordertimestamp) AS last_order_timestamp FROM customer c LEFT JOIN ""order"" o ON o.customer = c.id GROUP BY c.id, c.firstname, c.lastname HAVING MAX(o.ordertimestamp) < current_date - interval '6 months'     OR MAX(o.ordertimestamp) IS NULL ORDER BY last_order_timestamp NULLS FIRST LIMIT 200","SELECT     c.id,     c.firstname,     c.lastname,     MAX(o.ordertimestamp) AS last_order_timestamp FROM customer c LEFT JOIN ""order"" o ON o.customer = c.id WHERE (o.ordertimestamp IS NULL OR o.ordertimestamp < current_date - interval '6 months') GROUP BY c.id, c.firstname, c.lastname ORDER BY last_order_timestamp DESC NULLS LAST LIMIT 200"
webshopdb,mistral-nemo,zero-shot,11,1125.247,2.199,0.225,37,1124.438,2.256,0.238,37,0.0000121929,0.0000121788,1.001,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     COUNT(o.id) AS num_orders,     SUM(o.total::numeric) AS total_spent,     AVG(o.total::numeric) AS avg_order_value FROM customer c JOIN ""order"" o ON o.customer = c.id GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(o.id) >= 3 ORDER BY avg_order_value DESC LIMIT 20;","SELECT     c.id,     c.firstname,     c.lastname,     COUNT(o.id) AS num_orders,     SUM(o.total::numeric) AS total_spent,     AVG(o.total::numeric) AS avg_order_value FROM webshop.customer c JOIN webshop.order o ON o.customer = c.id GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(o.id) >= 3 ORDER BY avg_order_value DESC LIMIT 20;"
webshopdb,mistral-nemo,zero-shot,12,1254.474,21.283,0.426,538,1159.664,NaN,NaN,,0.0000136789,0.0000126738,1.082,False,False,"SELECT     p.id AS product_id,     p.name AS product_name,     COALESCE(SUM(s.count), 0) AS total_stock,     COALESCE(SUM(op.amount), 0) AS total_sold FROM products p JOIN articles a ON a.productid = p.id LEFT JOIN stock s ON s.articleid = a.id LEFT JOIN order_positions op ON op.articleid = a.id GROUP BY p.id, p.name HAVING COALESCE(SUM(s.count), 0) < 10   -- “baixo” estoque ORDER BY total_stock ASC, total_sold DESC;","SELECT     p.id AS product_id,     p.name AS product_name,     COALESCE(s.total_count, 0) AS total_stock,     COALESCE(op.total_amount, 0) AS total_sold FROM products p LEFT JOIN LATERAL (   SELECT SUM(count) AS total_count   FROM stock   WHERE articleid = a.id ) s ON TRUE LEFT JOIN LATERAL (   SELECT SUM(amount) AS total_amount   FROM order_positions   WHERE articleid = a.id ) op ON TRUE WHERE COALESCE(s.total_count, 0) < 10   -- “baixo” estoque ORDER BY total_stock ASC, total_sold DESC;"
webshopdb,mistral-nemo,zero-shot,13,1313.787,13.413,0.365,444,1412.099,13.335,0.363,444,0.0000143745,0.0000153448,0.930,True,True,"SELECT     date_trunc('month', o.ordertimestamp) AS month,     p.category,     SUM(op.amount * op.price::numeric) AS revenue FROM ""order"" o JOIN order_positions op ON op.orderid = o.id JOIN articles a ON a.id = op.articleid JOIN products p ON p.id = a.productid GROUP BY month, p.category ORDER BY month, revenue DESC;","SELECT     DATE_TRUNC('month', ""order"".""ordertimestamp"") AS month,     ""products"".""category"",     SUM(""order_positions"".""amount"" * (""order_positions"".""price""::NUMERIC)) AS revenue FROM ""order"" JOIN ""order_positions"" ON ""order_positions"".""orderid"" = ""order"".""id"" JOIN ""articles"" ON ""articles"".""id"" = ""order_positions"".""articleid"" JOIN ""products"" ON ""products"".""id"" = ""articles"".""productid"" GROUP BY month, ""products"".""category"" ORDER BY month, revenue DESC;"
webshopdb,mistral-nemo,zero-shot,14,1417.095,17.496,0.507,462,1174.839,NaN,NaN,,0.0000155130,0.0000127904,1.206,False,False,"SELECT     c.id,     c.firstname,     c.lastname,     COUNT(DISTINCT p.category) AS categories_bought FROM customer c JOIN ""order"" o ON o.customer = c.id JOIN order_positions op ON op.orderid = o.id JOIN articles a ON a.id = op.articleid JOIN products p ON p.id = a.productid GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(DISTINCT p.category) >= 3 ORDER BY categories_bought DESC, c.id;","SELECT     c.id,     c.firstname,     c.lastname,     COUNT(DISTINCT p.category) AS categories_bought FROM     webshop.customer c JOIN (     SELECT         o.customer,         COUNT(DISTINCT p.category) AS categories_bought     FROM         webshop.""order"" o     JOIN         webshop.order_positions op ON op.orderid = o.id     JOIN         webshop.articles a ON a.id = op.articleid     JOIN         webshop.products p ON p.id = a.productid     GROUP BY         o.customer     HAVING         COUNT(DISTINCT p.category) >= 3 ) sub ON sub.customer = c.id ORDER BY     categories_bought DESC,     c.id;"
webshopdb,mistral-nemo,zero-shot,15,1529.423,11.854,0.602,566,1155.131,NaN,NaN,,0.0000167875,0.0000127034,1.324,False,False,"WITH bounds AS (     SELECT (SELECT MAX(ordertimestamp) FROM ""order"") AS max_ts ) SELECT     a.id AS article_id,     a.description,     p.name AS product_name,     COALESCE(SUM(s.count), 0) AS current_stock,     COUNT(DISTINCT o.id) AS num_orders_recent FROM articles a JOIN products p ON p.id = a.productid LEFT JOIN stock s ON s.articleid = a.id JOIN order_positions op ON op.articleid = a.id JOIN ""order"" o ON o.id = op.orderid CROSS JOIN bounds b WHERE o.ordertimestamp >= b.max_ts - interval '1 year' GROUP BY a.id, a.description, p.name HAVING COALESCE(SUM(s.count), 0) = 0 ORDER BY num_orders_recent DESC;","CREATE INDEX IF NOT EXISTS idx_order_ordertimestamp ON ""order"" (ordertimestamp);  SELECT     a.id AS article_id,     a.description,     p.name AS product_name,     COALESCE(SUM(s.count), 0) AS current_stock,     COUNT(DISTINCT o.id) AS num_orders_recent FROM     articles a JOIN     products p ON p.id = a.productid LEFT JOIN     stock s ON s.articleid = a.id JOIN     order_positions op ON op.articleid = a.id JOIN     ""order"" o ON o.id = op.orderid WHERE     o.ordertimestamp >= (SELECT MAX(ordertimestamp) FROM ""order"") - INTERVAL '1 year' GROUP BY     a.id,     a.description,     p.name HAVE     COALESCE(SUM(s.count), 0) = 0 ORDER BY     num_orders_recent DESC;"
webshopdb,mistral-nemo,zero-shot,16,1299.502,6.996,0.221,425,1159.133,NaN,NaN,,0.0000141998,0.0000126797,1.121,False,False,"SELECT     p.id,     p.name FROM products p WHERE p.id NOT IN (     SELECT DISTINCT a.productid     FROM articles a     JOIN order_positions op ON op.articleid = a.id );","SELECT p.id, p.name FROM products p LEFT JOIN LATERAL (   SELECT DISTINCT articleid   FROM order_positions ) op(a) ON TRUE WHERE NOT EXISTS (SELECT 1 FROM op WHERE op.articleid = p.id);"
webshopdb,mistral-nemo,zero-shot,17,2334.806,386.598,0.399,128697,1279.057,NaN,NaN,,0.0000255157,0.0000141378,1.825,False,False,"SELECT     p.id,     p.name,     p.category,     a.reducedprice,     (         SELECT AVG(a2.reducedprice::numeric)         FROM articles a2         JOIN products p2 ON p2.id = a2.productid         WHERE p2.category = p.category     ) AS avg_category_price FROM products p JOIN articles a ON a.productid = p.id WHERE a.reducedprice::numeric > (     SELECT AVG(a3.reducedprice::numeric)     FROM articles a3     JOIN products p3 ON p3.id = a3.productid     WHERE p3.category = p.category ) LIMIT 50;","SELECT     p.id,     p.name,     p.category,     a.reducedprice,     AVG(a2.reducedprice::numeric) AS avg_category_price FROM     products p JOIN     articles a ON a.productid = p.id LEFT JOIN LATERAL (   SELECT a2.reducedprice   FROM articles a2   JOIN products p2 ON p2.id = a2.productid   WHERE p2.category = p.category ) a2 ON TRUE WHERE     a.reducedprice::numeric > AVG(a3.reducedprice::numeric) FROM (   SELECT a3.reducedprice   FROM articles a3   JOIN products p3 ON p3.id = a3.productid   WHERE p3.category = p.category ) AS avg_price LIMIT 50;"
webshopdb,mistral-nemo,zero-shot,18,1433.242,4.437,0.108,3921,1240.349,NaN,NaN,,0.0000156871,0.0000135094,1.156,False,False,"SELECT      c.id,      c.firstname,      c.lastname FROM customer c ORDER BY (     SELECT SUM(o.total::numeric)      FROM ""order"" o      WHERE o.customer = c.id ) DESC  LIMIT 50;","SELECT     c.id,     c.firstname,     c.lastname FROM     customer c ORDER BY     (SELECT SUM(o.total::numeric)      FROM order o      WHERE o.customer = c.id) DESC LIMIT 50;"
webshopdb,mistral-nemo,zero-shot,19,1451.303,1.825,0.102,2713,1429.485,1.323,0.202,37,0.0000158679,0.0000156245,1.015,True,False,"SELECT      c.id,     c.firstname,     (SELECT COUNT(*) FROM ""order"" o WHERE o.customer = c.id) AS total_orders FROM customer c WHERE c.id < 1000;","SELECT     c.id,     c.firstname,     COUNT(o.id) AS total_orders FROM     customer c LEFT JOIN     ""order"" o ON o.customer = c.id WHERE     c.id < 1000 GROUP BY     c.id, c.firstname;"
webshopdb,mistral-nemo,zero-shot,20,1289.442,0.908,0.066,19,1240.325,0.922,0.063,19,0.0000140936,0.0000135518,1.040,True,True,"SELECT      o.id,     o.ordertimestamp,     o.total FROM ""order"" o WHERE EXTRACT(MONTH FROM o.ordertimestamp) = 12   AND o.total::numeric > 50;","SELECT     o.id,     o.ordertimestamp,     o.total FROM     webshop.order o WHERE     EXTRACT(MONTH FROM o.ordertimestamp) = 12     AND CAST(o.total AS NUMERIC) > 50;"
webshopdb,mistral-nemo,zero-shot,21,1470.560,15.323,0.309,493,1499.682,15.858,0.328,493,0.0000160684,0.0000163961,0.981,True,True,"SELECT     p.id AS product_id,     p.name AS product_name,     COALESCE(SUM(s.count), 0) AS total_stock FROM products p LEFT JOIN articles a ON a.productid = p.id LEFT JOIN stock s ON s.articleid = a.id GROUP BY p.id, p.name ORDER BY total_stock DESC;","SELECT     p.id AS product_id,     p.name AS product_name,     COALESCE(SUM(s.count), 0) AS total_stock FROM webshop.products p LEFT JOIN webshop.articles a ON a.productid = p.id LEFT JOIN webshop.stock s ON s.articleid = a.id GROUP BY p.id, p.name ORDER BY total_stock DESC;"
webshopdb,mistral-nemo,zero-shot,22,1192.290,0.028,0.089,1,1178.612,0.040,0.085,1,0.0000130312,0.0000128840,1.012,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     c.email,     c.created FROM customer c WHERE c.created >= CURRENT_DATE - INTERVAL '30 days' ORDER BY c.created DESC;","SELECT     c.id,     c.firstname,     c.lastname,     c.email,     c.created FROM     webshop.customer c WHERE     c.created >= (CURRENT_DATE - INTERVAL '1 month') ORDER BY     c.created DESC;"
webshopdb,mistral-nemo,zero-shot,23,1169.534,8.817,0.335,425,1080.105,8.338,0.293,425,0.0000127998,0.0000118539,1.083,True,True,"SELECT     p.id AS product_id,     p.name AS product_name,     SUM(op.amount) AS total_sold FROM products p JOIN articles a ON a.productid = p.id JOIN order_positions op ON op.articleid = a.id GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 20;","SELECT     p.id AS product_id,     p.name AS product_name,     SUM(op.amount) AS total_sold FROM     webshop.products p JOIN     webshop.articles a ON a.productid = p.id JOIN     webshop.order_positions op ON op.articleid = a.id GROUP BY     p.id, p.name ORDER BY     total_sold DESC LIMIT 20;"
webshopdb,mistral-nemo,zero-shot,24,1183.869,0.068,0.605,4,1200.679,NaN,NaN,,0.0000128829,0.0000131248,0.986,True,True,"SELECT     c.id,     c.firstname,     c.lastname,     COUNT(DISTINCT p.category) AS categories_bought FROM customer c JOIN ""order"" o ON o.customer = c.id JOIN order_positions op ON op.orderid = o.id JOIN articles a ON a.id = op.articleid JOIN products p ON p.id = a.productid WHERE o.ordertimestamp >= CURRENT_DATE - INTERVAL '6 months' GROUP BY c.id, c.firstname, c.lastname HAVING COUNT(DISTINCT p.category) >= 4 ORDER BY categories_bought DESC;","SELECT     c.id,     c.firstname,     c.lastname,     COUNT(DISTINCT p.category) AS categories_bought FROM     webshop.customer c JOIN (     SELECT         o.customer,         op.orderid,         a.productid,         p.category     FROM         webshop.""order"" o         JOIN webshop.order_positions op ON op.orderid = o.id         JOIN webshop.articles a ON a.id = op.articleid         JOIN webshop.products p ON p.id = a.productid     WHERE         o.ordertimestamp >= CURRENT_DATE - INTERVAL '6 months' ) sub ON sub.customer = c.id GROUP BY     c.id,     c.firstname,     c.lastname HAVING     COUNT(DISTINCT sub.category) >= 4 ORDER BY     categories_bought DESC;"
webshopdb,mistral-nemo,zero-shot,25,1207.924,17.526,0.325,520,1167.212,21.528,0.339,520,0.0000132041,0.0000127583,1.035,True,True,"WITH stats AS (     SELECT         a.id AS article_id,         a.description,         SUM(op.amount) AS total_sold,         COALESCE(SUM(s.count), 0) AS current_stock     FROM articles a     LEFT JOIN stock s ON s.articleid = a.id     JOIN order_positions op ON op.articleid = a.id     GROUP BY a.id, a.description ) SELECT     article_id,     description,     total_sold,     current_stock,     (total_sold * 1.0 / NULLIF(current_stock, 0)) AS demand_index FROM stats ORDER BY demand_index DESC NULLS LAST LIMIT 10;","WITH stats AS (     SELECT         a.id AS article_id,         a.description,         SUM(op.amount) AS total_sold,         COALESCE(SUM(s.count), 0) AS current_stock     FROM articles a     LEFT JOIN stock s ON s.articleid = a.id     JOIN order_positions op ON op.articleid = a.id     GROUP BY a.id, a.description ) SELECT     article_id,     description,     total_sold,     current_stock,     (total_sold * 1.0 / NULLIF(current_stock, 0)) AS demand_index FROM stats ORDER BY demand_index DESC NULLS LAST LIMIT 10;"
